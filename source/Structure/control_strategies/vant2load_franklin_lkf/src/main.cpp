/*
 * This file is part of the ProVANT simulator project.
 * Licensed under the terms of the MIT open source license. More details at
 * https: //github.com/Guiraffo/ProVANT-Simulator/blob/master/LICENSE.md
 */
/**
 * @file main.cpp
 * @brief This file contains the implementation of the control law.
 *
 * The mathematical background used to design this controller is presented in
 * the paper "Suspended Load Path Tracking Control Using a Tilt-rotor UAV Based
 * on Zonotopic State Estimation" publised in Journal of the Franklin Institute
 * from authors Brenner S. Rego and Guilherme V. Raffo, and is available at
 * https://arxiv.org/pdf/1809.07870.pdf.
 *
 * @author Brenner S. Rego
 */

#include <control_strategies_base/icontroller.hpp>

#include <eigen3/Eigen/Eigen>

#include <simulator_msgs/Sensor.h>

#include "vant2load_franklin_lkf/feedforward.h"
#include "vant2load_franklin_lkf/linear_kalman_filter.h"
#include "vant2load_franklin_lkf/routines.h"

#include <cmath>

class vant2load_Franklin_LKF : public Icontroller
{
private:
  Eigen::VectorXd Xref;

private:
  Eigen::VectorXd Erro;

private:
  Eigen::VectorXd Input;  // This vector includes the applied disturbances
private:
  Eigen::MatrixXd K;

private:
  Eigen::VectorXd X;

private:
  Eigen::VectorXd Xstates;

private:
  Eigen::MatrixXd LKF_X0;

private:
  Eigen::MatrixXd LKF_P0;

private:
  Eigen::MatrixXd LKF_Q;

private:
  Eigen::MatrixXd LKF_R;

private:
  double T;

private:
  double equil_phi;

private:
  double equil_theta;

private:
  double equil_psii;

private:
  double equil_g1;

private:
  double equil_g2;

private:
  double equil_aR;

private:
  double equil_aL;

private:
  double equil_fR;

private:
  double equil_fL;

private:
  double equil_tauaR;

private:
  double equil_tauaL;

private:
  Eigen::MatrixXd equil_output;

private:
  double PI;

public:
  vant2load_Franklin_LKF()
    : Xref(24)
    , Erro(24)
    , Input(7)
    , K(4, 24)
    , X(24 + 23 + 46 + 1 + 1 + 3 + 3)
    , Xstates(24)
    , LKF_X0(23, 1)
    , LKF_P0(23, 23)
    , LKF_Q(23, 23)
    , LKF_R(16, 16)
    , equil_output(16, 1)
  {
    // Controller sampling time
    T = 0.012;

    // Equilibrium values
    equil_phi = 0;
    equil_theta = 0;
    equil_psii = 0;
    equil_g1 = 1.316967145565129e-04;
    equil_g2 = 0.013960153151247;
    equil_aR = 0.014005280124626;
    equil_aL = 0.013809089793911;
    equil_fR = 11.732256727680697;
    equil_fL = 11.767602459917352;
    equil_tauaR = 4.138868162580376e-07;
    equil_tauaL = 1.012099978192413e-05;

    equil_output << -0.001661204266230097, 1.567038189486787e-05, 0.6189884034468275, -0.000131709548513303,
        -0.0139601530301764, 1.838625741689666e-06, 0, 0, 0, -0.006979849797580309, 6.584835708791055e-05,
        -0.4999512749866701, 0.01400528012462612, 0.01380908979391114, 0, 0;

    // Mathematical constant PI
    PI = 3.14159265358979323846;
  }

public:
  ~vant2load_Franklin_LKF()
  {
  }

public:
  void config()
  {
    // SBAI gain matrix
    // K <<
    // 0.7101244468428165,6.141471260155515,7.765440795725267,-18.97385920336097,1.826066960066656,-0.09338611048322061,17.57791369983566,-0.7164683413615529,-0.03350735071807359,0.4235128078145839,0.2708588223207514,4.311055003650324,4.170146360015496,-5.072227698361692,0.3809539101204998,-0.06650607548831029,2.122392130887405,-0.02473442956879733,0.0006404185518007683,0.008513558472367464,0.4662177448319676,3.523707063368016,5.320429316782071,-0.1472247707396855,-1.571274680558446,-8.596271330525751,6.985745062499001,21.91480875426527,-1.94921538690414,0.09535891280953998,-18.42904004957552,0.4434387926540275,0.1072202681687932,-0.317249054464631,-0.9548973567439005,-5.910676814456982,4.55703288130231,5.454379896200787,-0.2518284755625079,0.06360770401465654,-2.133681658482248,-0.008445306788653999,0.001718825918710477,-0.005954099368496411,-1.2250793041699,-5.503330766582297,3.925043415306752,0.09204438852464802,0.1952075590979948,-0.03032542746108816,-0.003380038380425396,0.06292464197787898,0.3808490158409268,0.04098134842638689,-0.0437294922542443,-0.1815063858105274,0.1672299855993115,-0.004950772796723103,0.1160491338776613,-0.01901526180028523,-0.01046202265880625,0.01457474072728251,0.07364843512499895,0.02819675274652457,-0.003764578805403473,-0.008102716027547696,0.004792989032152177,0.000274744109690024,0.1320526541764119,-0.01982603318640202,0.008140109577766043,0.01296630640217303,0.1858289717940038,-0.004531750410384653,-0.001691334240977282,-0.01099980803116952,0.3650350924346544,-0.03429654457475473,0.02114487202233904,-0.1765601446988155,-0.0087900241089497,0.1676412256268605,0.1107587378532268,-0.0008316297740917086,-0.0101361709665762,-0.00430220334492462,0.07112118136129204,-0.02734833615631714,0.002775618184624419,-0.007952050965466266,0.000294409460551884,0.004683773810332413,0.1255028830715101,-0.004335263292000928,0.009748974116588649,-0.01431313055730361;

    // Nominal: DLQR (Gain Matrix 1)
    // K <<
    // 0.003935196633348463,8.164143718471177,8.413105388688178,-17.11073148562869,0.03840738701584823,0.0779527831055818,11.45802951147174,-0.03542713973956791,0.01583801692692363,-0.01494010798615987,0.004944727368668204,4.837310697087232,4.503741995676854,-4.017137761401258,0.01983930073594401,0.04654111835275444,1.29879827930462,-0.01826986282006559,0.005625333167263975,-0.00560790900910969,0.001617928871397988,6.458246952468847,7.271291184019157,0.03948290087785661,0.002027545267086379,-8.109081428447061,8.438833538963793,17.00562952393637,0.03606797199478454,-0.07740484711899505,-11.39168475622721,-0.03440550155647644,-0.01492080891663605,0.01518338197655425,0.004041335904892467,-4.805582964376594,4.517495659812365,3.996197961463364,0.01953318212695879,-0.04621693893140372,-1.295060750460914,-0.01831835025418072,-0.005585995894016641,0.005573718240356276,-0.000196846731394436,-6.414154815901282,7.293008264914852,-0.03920430426105528,0.357849701527772,-0.01333021376394783,4.425966645373326e-05,0.03545840239950954,0.7818762510442566,0.07971790939163337,-0.02410887233964124,-0.4688802441252272,1.116989383865668,-0.05365870081491189,0.2161776552445624,-0.008865779808838667,2.360603347435701e-05,0.009645496498088206,0.1885397256423781,0.05491516486464854,-0.003648032757006852,-0.05409658732973515,0.01076277891887479,0.0004771925933762313,0.2782819376674097,-0.00937480841929892,-3.007051898317645e-05,0.03794114163010181,0.3576289147971125,0.01323914657658174,4.862959181472948e-05,-0.03519912606034137,0.7818355337551153,-0.07981290564297025,0.02388720972529422,-0.4682872195583456,-0.05391149110058534,1.117107381898103,0.2161070050815737,0.008803409187350217,2.644305763173375e-05,-0.009571480056048243,0.1885833907109003,-0.05500669726932385,0.003611029976643186,-0.05406121622332708,0.0004688363676850783,0.01075514466293162,0.2780209194358241,0.009311920922186757,-2.62035112528868e-05,-0.03797833122642472;

    // Nominal: DLQR (Gain Matrix 2)
    // K <<
    // 0.001376739198937637,4.10639331403195,4.559798815798978,-12.66569576381745,0.02133904952520624,0.09135045610153263,9.782371102493586,-0.01995764499565263,0.04726092983156967,-0.04665375891811101,0.002153591940600475,3.06906901414886,3.337777387340877,-3.328503117052637,0.01420208500381954,0.05587606519217934,1.16259316232294,-0.01348024972566418,0.005979354294787913,-0.00596080133754653,0.000429182840992686,2.057477617189907,2.313137970035948,0.04583350589710378,0.0004321741372855079,-4.078517587770402,4.573613239350637,12.58555046906684,0.01960104690285259,-0.09070376366458324,-9.722491070721086,-0.0189518152500941,-0.04638325618824011,0.04640959967766496,0.001584431352663537,-3.048625699246735,3.347958452848885,3.310362104332723,0.0139420663939293,-0.05548389433566071,-1.158420558138916,-0.01351635126043956,-0.005935928969851226,0.005923816079428422,-0.0001029325663893942,-2.043416446621231,2.320060974272172,-0.04550800063803574,0.1788632299170274,-0.007599709573041279,7.994286092480083e-06,0.02865934594316999,0.5739027575604522,0.07971843657632079,-0.02150260161721812,-0.3871975424419916,1.081635710385112,-0.08888735846955266,0.1360815900420663,-0.006247916178011425,1.554700521033937e-05,0.008575663561794983,0.155016828569,0.05491735530377476,-0.003432716860026531,-0.0471399089367247,0.01026384264075904,-1.978467337904302e-05,0.08866414136075766,-0.003577648638756726,-7.123296872796631e-06,0.03794080145958001,0.1788111778912194,0.007556766645693908,1.091599095503243e-05,-0.0284802325234879,0.5740129587371805,-0.07976988306771532,0.02132768181950087,-0.3866608635799253,-0.08913901418699452,1.081795420039133,0.1360757927458273,0.006210992821202368,1.784934030165836e-05,-0.008518319301857757,0.1550835094080316,-0.0549749382814788,0.003400910721996158,-0.04710913611320009,-2.862225989544298e-05,0.01025730825111871,0.0886232719149528,0.003557988231075785,-5.629149866240526e-06,-0.03795851511387448;

    // Nominal: Version 1
    // K <<
    // -1.323000431092713,3.814754097193253,11.62763251296858,-14.51060269836333,-0.836959735737397,0.5148897546222578,14.85447460248879,0.4974755906446917,-7.047899966571762,10.05131094039985,-0.6190441542784982,3.01936533176857,5.20517745790634,-4.097068934232062,0.00122030545498248,-0.1242761526750772,1.924322255028726,-0.03272694589512604,-0.2974457772325438,0.3740815146936236,-1.468788155238638,1.790771837580875,10.65875862761146,0.572866277696913,-0.9314438839012262,-5.548438477322249,11.33519972358793,14.88676928093411,0.1211807916778585,-0.3413029835113952,-13.97121415390814,-0.2448368304765016,9.76479824085407,-5.682375522375405,-0.3842269066311151,-3.883578028974158,5.292704520017035,3.961683501391633,0.2057598369395902,0.2350837797245765,-1.809556636095195,-0.1052467156345451,0.3672392261625704,-0.2594445321648555,-0.9934327483207346,-3.672375491731709,10.45524098459296,-0.4561987982484454,0.053160318295129,0.01831847416215292,0.0002064332603313206,-0.0491984778367893,0.1730913056400256,0.009320485644418839,0.04830261016279114,-0.1164223719880345,0.2811058412630562,0.185313681219218,0.03901585950807417,0.01236859483364737,-0.00132220485240061,-0.01276027216937946,0.04994327496985658,-0.0001742617703074358,0.005579808157716977,-0.02077667096579222,-0.0183326464839224,0.003052050226965657,0.0310201386453351,0.01187164976206709,-0.002906359607732772,0.009457782394609827,0.05644305116513206,-0.007375939188005301,0.0007174741450496246,0.02693550594476659,0.1801593639689882,-0.01494679892403626,-0.02895760449981919,-0.1217812834374863,0.183906218096406,0.2925750245883649,0.04097305791649036,-0.006096748368744254,-0.0008814944275708132,0.007360558200411883,0.05162776490546817,-0.01526907108946667,-0.003387843506333046,-0.02136239797978148,0.003600004230595395,-0.01863922042517533,0.03415362167745017,-0.003957694539470675,-0.002306253966318808,-0.002288230750291435;

    // Nominal: Version 2
    // K <<
    // -0.3691940764393805,9.137397630891407,11.99533740570126,-18.92429862852764,0.5355513330725553,0.3499469454375888,12.14507016557985,-0.5325275576301141,3.727135059538108,-2.736202470749058,-0.1853521828107303,5.236346514709775,5.2119478179082,-4.30941349513371,0.2059127255326379,0.2936329732365346,1.347771710424823,-0.07666693745573651,0.07225131257586839,-0.05053976582267928,-0.377443771202215,7.479742312089884,11.43072876370773,-0.05660029635542344,-1.361321075482054,-11.48422232562893,11.44317671726317,20.76442837425995,-1.091857881643973,-0.2631418550177534,-12.61932799229078,0.2759646409452172,-3.214489804980985,2.996017581379637,-0.6887433233629655,-6.468288046362111,5.426404116657467,4.520425414745985,-0.1190047861318379,-0.2823059822526686,-1.380763267692343,-0.002708252212826299,-0.05692789958414084,0.05856947302878674,-1.335417473332026,-9.702064627051765,10.193481231805,0.1091830804758886,0.506272624659228,0.04302867216476516,0.01780072578103263,-0.07151875413845973,0.9360030814452887,-0.01271640897993063,0.03469554841454384,-0.5200662488812098,0.4875540730980505,0.3558315975124064,0.2823306627532509,0.02245995541761917,-0.005512693868307899,-0.01375770962568368,0.2044510745428521,0.0003176000484815227,0.002968538247433963,-0.05691692061913129,-0.01775784662330652,0.007453062960600819,0.4300730351984041,0.04112237215460453,0.03155988759378672,-0.005446971443990427,0.5589704098847695,0.04036475329493176,0.02126925591346647,-0.07796659797999768,1.027100464659651,-0.08175809548500139,0.04269999806690482,-0.565361268869422,0.1549559435493564,0.7737784053749822,0.3108470857566313,0.02250203266996247,-0.005427640407868771,-0.01691803359300803,0.2235066711146993,-0.03880574840452002,0.004462658288448392,-0.06146001539400443,0.006771951486148446,-0.01525506349196384,0.4757869948096474,0.03711327478363256,0.03537850526760233,-0.04403317834603471;

    // Nominal: Version 3
    // K <<
    // -0.1628951956514104,2.588127965986212,11.85702881169268,-12.54009978696741,0.9090026005879285,0.2819382086893901,13.83327289510416,-0.7813586564104901,-2.576641293105328,4.93177234140593,0.01516810975523182,2.361260403383247,5.269021744251194,-3.687059459866708,0.3632561344604576,0.0730413713118882,1.841840017756668,-0.1260639208245989,-0.09352683397580849,0.1486454777527212,-0.188258962874165,0.6735094416452146,11.02427465624994,0.2223943615353017,-2.359531277558356,-4.128748744173133,11.24271928341305,12.55445863671159,-2.641622741910636,-0.2508442357871398,-12.70485373305955,1.407841004602939,3.577783524642367,-3.23908138223071,-1.231756427866591,-3.107641367334839,5.254920248828925,3.47253453541575,-0.4392283794016134,0.0006602465356375637,-1.707725399194273,0.06879799075671959,0.120114776317977,-0.1083368126086854,-2.314690821249581,-2.376467288566122,10.27744312525227,-0.2360490701431765,0.1172147117421225,-0.01648640924963988,0.003014475046286675,0.009057439094423999,0.320606183487087,0.02460542926387071,0.02042853935365081,-0.2137137499450776,0.8211024033741979,-0.09432778789819991,0.0803353289091109,-0.006609870805301796,-0.001136441966102288,-0.0003197830117976606,0.08689151612881532,0.01462687741776819,0.002658549637560447,-0.03271780595353994,-0.008441951625671514,-0.001387499358052391,0.08518305422155126,-0.01995698003094154,0.002095610316459078,0.01355627066040822,0.1081658185011033,-0.02198775178728441,0.003132076182270857,0.04604763283684565,0.3066201778928501,-0.03423241051747868,-0.03744696450600177,-0.2055968461518413,0.1402899154506778,0.5777713504875451,0.07515311292913755,-0.01332586547521313,-0.001538185846434963,0.01035371109855615,0.08386539977613462,-0.02995900705608361,-0.002947571317915805,-0.03204812005047138,0.002637678417830726,-0.01263717866053592,0.07600458621616409,-0.01851057329702557,0.001507442300835428,-0.008113106480948774;

    // Nominal: Version 4
    // K <<
    // -0.481985605757965,3.102586147460362,11.82945237417833,-13.35855621162734,0.221292919630983,0.242059596423404,14.28375913221375,-0.3363106614263635,-3.132065778765186,3.890745855713152,-0.1840335670512633,2.640811447995264,5.264135044883305,-3.854854294672392,0.1857632254474888,0.1309511866052441,1.871827014428712,-0.06280117309301012,-0.05563630530142293,0.06666811011820292,-0.4867054355252461,1.170961672929134,10.97285328059406,0.1527398152696417,-2.334312012362799,-4.523316442802424,11.29600093964813,13.1563008343681,-2.877372738938116,-0.2519428436126972,-13.01024243273382,1.643525016870614,3.303877526614714,-4.058150927582677,-1.254212522672654,-3.313098849255604,5.278871369988863,3.592252025620019,-0.5184906623382259,-0.05384558144261138,-1.725931541922927,0.1114746783445955,0.05396013301518305,-0.07455594002855456,-2.168655325584032,-2.746462134904459,10.32812981776004,-0.1896932803573184,0.3094697332318433,0.007144400606286751,0.002609500833808471,-0.02508899682525286,0.8225060886998301,0.01880010909158887,0.03735525260149915,-0.4990083326803467,1.474434048608325,0.575996743810226,0.209720795749463,0.005791891844940294,-0.007505693954287021,-0.007508170912769613,0.2193938050289035,0.01299371682734443,0.003907276052251971,-0.07522475525739862,0.0106851986665023,0.007224323498313551,0.2273963154142121,0.003497437784556523,0.001069402322136731,0.01382464294326094,0.3081461332550223,0.01154742256340154,0.004056116145712431,-0.005939395308522449,0.8227393649214214,-0.03302438087015108,-0.01247896718168198,-0.5003831153572333,0.6289102801140938,1.432501743328966,0.2091033450078991,0.004693334533461635,-0.007226408079438753,-0.0008827565608291607,0.2198106740720244,-0.02579759247709905,-0.001175098136658861,-0.07561316209421104,0.006889671870765101,0.01114675566462399,0.224740444334206,0.01432013857761174,0.002502109598586404,-0.006018653904239225;

    // Nominal: Version 5
    // K <<
    // -4.11425912498984,7.346291017220474,21.11609011772429,-28.13742024090932,-3.535965814453472,1.002810035052793,27.68912002102117,1.885201679126742,-7.774896864523282,7.72990848790173,-1.723783332881671,6.168078152891763,7.172803870323555,-7.619960347190479,-0.5364364757472726,0.2479558210891487,3.149966272599748,0.09225331635635489,-0.2146885219719701,0.2038208813141722,-4.459958704378607,3.16310260430746,26.8188646360941,0.532779527545139,-4.346493019297935,-9.919341404572561,21.530778099735,25.05875462304854,-3.591891406251222,0.09023298618846884,-24.25639364645335,1.795746610775851,6.705776765502922,-7.01356275881389,-1.832707028125472,-6.530855314465599,7.429882710128405,6.613127321583428,-0.5740162178623954,-0.1740263381421507,-2.830046310155327,0.08656201350157268,0.1899723085951041,-0.1929092482947732,-4.539039005823733,-7.24520351986317,26.77080937099641,0.1009385620921177,0.2688588337818082,-0.0208037980670664,-0.05716175316769481,0.02271448342638681,0.8751405826010377,0.09176436876389063,0.02471872046715558,-0.6008889578611368,2.075309231957101,0.3043598408750631,0.2028944478757578,-0.009425365402000457,-0.02046968790400133,0.001479130434842338,0.2455919100443629,0.06066012742566083,0.001179228383109246,-0.09449931184434561,0.01816151871447666,0.005460208146874297,0.1607071950527417,-0.02088849183067737,-0.104377628745375,0.03049609224378404,0.2674553508399705,-0.06730140418289293,-0.05467440377406375,0.1414973985823328,0.8777887916049837,-0.03425877422486322,-0.1067435470160775,-0.6046968192444692,0.4530640271637799,1.937276031892027,0.2024522183848233,-0.04052266803112055,-0.0212983792315188,0.02993232835364771,0.2469096230369496,-0.03646308367595994,-0.007717348222263077,-0.09528557288312434,0.009501098902792719,0.01436003780851552,0.1586086096701572,-0.05338516787585418,-0.1037793518794007,-0.01386586210401385;

    // Nominal: Version 6
    // K <<
    // -4.740962787335878,22.1451755755315,23.78046620104359,-42.61171664356659,-4.606374592067958,0.6587506115026567,24.24562279986441,2.049076665213466,6.60567959529783,-9.808450307114869,-2.1605169444236,12.53293759325883,7.601968924254414,-8.893045563318351,-0.8635785350874083,0.677415023370136,2.344563274892226,0.1742598322128012,0.0003444908220796291,-0.1070571902281687,-4.626007344312597,18.50686261004873,29.62725371101032,-0.2598989426395328,-3.894275604191186,-26.76452200087341,22.32371022451852,43.82590937876283,-3.12593475383531,-1.169769081888954,-24.45949550679072,1.311999708702698,-9.591682998128276,7.343759479141335,-1.675537669443966,-14.23396285307026,7.553999422594157,8.989814016003162,-0.5443498148830089,-0.7095757553643035,-2.362128209061679,0.09227335599409804,-0.1117099134751482,0.01242549382412219,-3.948831488498498,-23.54253493265823,27.4865854373587,0.3860843246124059,0.6059454550949741,0.07232626484284452,0.02277073706868715,-0.1144990871104274,1.107430081337397,0.08069460630687121,0.05687669455609813,-0.6277730454158965,0.665782435836702,0.1643578229239674,0.3380111091390324,0.03773911324075264,0.002120477042029952,-0.02141496837424209,0.2389682689177126,0.03650040814452184,0.004377083057703898,-0.06611001102570366,-0.01154862491701219,0.005541242315877868,0.5132238691015703,0.06620144730627434,0.03553639369939106,0.05813082437267545,0.5433458361092914,-0.06023756534729727,0.01638893875986515,0.08683453483180015,1.003230644724658,-0.02015043939852685,-0.03695909000484891,-0.5737631115772884,0.1416785615546985,0.6250921907985225,0.3046410776030558,-0.03021330574954902,0.002068454740894438,0.01469918813268728,0.218151568389388,-0.02159090592420596,-0.002201643784213157,-0.06116882901032464,0.004863337935729404,-0.01331938453201657,0.4582727825064153,-0.05377230222224767,0.02493382404518352,0.0120660287168157;

    // Trajectory SBAI: Version 1
    // K <<
    // -4.028029908850879,29.31974977482789,26.29875232363773,-57.52466339233692,-3.002332097339054,0.5875263363613253,32.73910429895498,1.491755802689672,0.9886962780344493,-2.205272044889789,-1.675978922769304,16.9727891489087,8.422103856095795,-11.97599072742681,-0.5387655308173812,0.1950610364187521,3.120789697439086,0.1242779402959597,-0.02194247307694915,-0.03142185211426334,-3.81760158124966,24.08714594912154,32.70310950478004,0.4755984980843908,-3.954539592958528,-34.62764490187687,24.30398190795972,59.1063431597704,-2.841994899974314,-0.7566904298800869,-33.29169751912604,1.422317054604278,-2.128487434430477,0.8739049127967981,-1.610710942415056,-18.84992554518019,8.26752402265976,12.18439130711853,-0.500490663070606,-0.224225802581438,-3.163309516104999,0.1153303240523951,-0.03267124617410887,-0.01971710021291394,-3.866842574907449,-29.45573231885738,29.97248363950525,-0.5988196740521502,0.07963775124705195,0.07289980398042123,-0.000110040832591541,-0.1296550452989267,0.1474642165644734,0.01933691946790353,0.07065148286898162,-0.1249566265922994,-0.2067185824120651,0.03811240052271923,0.04479650165092359,0.04030804393138811,-0.000981787771808292,-0.02648709041899779,0.03149308434673349,0.007842712750067616,0.006625220955253932,-0.01573165621862154,-0.04455100431013135,-0.0007007241790488379,0.06615339129728687,0.06153810557830004,9.578119987049632e-05,0.01419442816517159,0.07775058922034675,-0.07331063244529137,-0.004648768037199032,0.131499486029843,0.1451251438358476,-0.02160063667696028,-0.0712836575323252,-0.1243442420305231,0.03671678381325541,-0.2066288155780673,0.04395847655985629,-0.04078679158861644,-0.001360708100393158,0.02667380877159022,0.0311280695073855,-0.007931125636055017,-0.006652484500494307,-0.0156705189578909,-0.0007163151061142168,-0.04456081372864469,0.06406713083828901,-0.06183988840447797,-0.006651127850056868,-0.01432409808142779;

    // Trajectory SBAI: Version 2
    // K <<
    // -2.813371639356942,18.85044576601418,27.28631091894196,-42.42306597459311,-0.2387018285215916,-1.227352798837225,27.28480962730744,0.4270051314509621,-8.503855339738264,12.39065922224951,-0.9743675305020939,11.73409909539877,9.34029897219269,-9.599323179829234,0.09589742596222187,-0.5665198379454088,3.040106439163272,-0.02036471225195394,-0.2311036216293229,0.3349557435533372,-3.383283167389116,14.63132756833919,35.04901663290011,-0.7746546841498245,-2.479854847234222,-24.40344235828262,26.46505261970885,44.0562306587438,0.503390446771867,0.4842155219816491,-28.20099226508507,-0.03498805436750659,12.32404248164532,-7.859508699659952,-0.7407332652367441,-13.71159609662338,9.034913613425326,9.887835672963877,0.2476058492130761,0.4803517743205784,-3.121527017639518,-0.06201176730810939,0.3375296298498561,-0.2179787672051189,-3.091343189124326,-20.08012023587726,32.71822080368743,0.3830239412963191,0.01441492228852212,0.06009011039403243,0.002464323813034953,-0.1193871102181811,0.03190498205115982,0.001882129543866346,0.07447410542498968,-0.06480448850733203,-0.3395117711322023,0.08816904654479817,0.008664031339248176,0.03521258346758073,0.001039626332468382,-0.02674596427608494,0.007840435343110703,0.0002202718812399905,0.008366364463339666,-0.01014095976245805,-0.046546721247087,0.0001948114170954787,0.01088402580514011,0.04830787177421263,0.005452928912349123,0.001137133402750165,0.01506531056999781,-0.05902463901793954,0.000210478178380261,0.1171205767100509,0.03364725469864521,-0.002492692567006191,-0.07317500532634051,-0.06653445578773891,0.08689922759128796,-0.3371299547561984,0.009186605176844172,-0.03469454082354659,0.000156296127197717,0.02632021819188218,0.008217391373077388,-0.0003393125066138606,-0.008222930967285422,-0.01027940827028071,0.0001530266915010234,-0.04645176981730077,0.01144894828702865,-0.04749665289880461,-0.001365191864899009,-0.001425393579225544;

    // Trajectory SBAI: Version 3
    // K <<
    // -2.028163752377533,11.95913864511458,13.19537556416748,-25.16576104438507,-2.143010238225008,-0.1051975098005271,15.9237066016824,0.985602217864575,-0.7628970239452519,-0.04756407836536031,-1.033741451812144,7.057875768480163,5.82048083389833,-5.654628803542017,-0.3439067412293412,-0.01362389716064073,1.723146663695683,0.06942596609746236,-0.007555883854660605,-0.02902573100746556,-1.644086738838806,9.74496172230833,12.42623690853354,0.03267403058823774,-1.87566978589955,-14.8655614446674,12.40656388003388,27.44700970266428,-1.813530961342136,-0.02559425591083818,-16.67043412731048,0.8311479915974405,-0.1183382734283743,-0.5536378298759431,-0.9171961973430899,-8.463901300418577,5.982707014358185,5.964216796836984,-0.2793387293814815,0.0006558204548089253,-1.782312536411209,0.05546829812602213,-0.03348927536226289,0.0006418851841910294,-1.614812412255041,-12.13490672951599,10.87551830876487,0.007439416636767821,0.03524728386879441,0.03329323141039347,-0.002515891586644403,-0.06355679339914568,0.06942429314386757,0.007538856696631402,0.03722337732433257,-0.08512828576454332,-0.281112424126103,0.05831640538296034,0.02030133006605486,0.0189522863645994,-0.00235596610674526,-0.01391122184511928,0.01563128470945062,0.00330696212626368,0.004069507663543904,-0.01207350439559473,-0.04592421254252334,-0.0004156818811842162,0.0284936729582601,0.02719093964447744,-0.0008715511599454345,0.005512789362222622,0.0340464973045156,-0.03291321307102651,-0.004000733479587396,0.06390462685540657,0.06760478362918065,-0.009083067148520082,-0.03726038918864916,-0.08471941997498723,0.05726977712241431,-0.2812389390694312,0.01974429574071889,-0.01903250938395613,-0.001752020110692152,0.01386242206654735,0.01529024840136295,-0.003408397444383846,-0.004050680567241601,-0.01202148114208089,-0.0004366175566374853,-0.04592306322715468,0.02719009399201364,-0.02717084014610464,-0.004616684050849857,-0.005782094640342505;

    // Trajectory SBAI: Version 4
    // K <<
    // -2.231103673497543,11.83125950060126,13.64807927410613,-25.06460105269451,-2.296002549555325,-0.2140647343772626,15.85656917863938,0.9361886071428746,-2.074580363656266,0.9296072599176012,-1.10107991850235,7.015636877513542,6.08014760324397,-5.63215219675122,-0.362466442638356,-0.04712059644641656,1.718184016662806,0.06353301626033904,-0.04106209099209245,0.0127362507244764,-1.777778040286804,9.698359318296156,12.86268758955002,-0.0879496351683547,-2.060728678196561,-14.9180129096317,12.86591587114334,27.4736631753649,-1.920885967952019,0.07819916199723195,-16.69204326587909,0.7619030949373433,0.8267523367628892,-1.714192926482557,-0.9722942015006684,-8.472910742371681,6.236049134259446,5.972536572083314,-0.285922627201937,0.0320512499590813,-1.785320835437948,0.04734714208315541,0.008521026598570673,-0.02956959124797053,-1.738908326777121,-12.11036912323121,11.33708026268908,0.01907249357124937,0.01842575087333717,0.03528604662871051,0.0001435716560378204,-0.06830225575876654,0.03849387455854304,0.003736384483762659,0.04012377486528728,-0.07125169937561814,-0.3270722787275811,0.06369706945870085,0.01067812791653894,0.02023827451602556,-0.0008307892773564197,-0.01495953664652955,0.00875829748767898,0.00194538168082804,0.00441089548547827,-0.01038093346508829,-0.04630167689079317,-0.0005222577162980258,0.01444038903060213,0.02885685977238476,0.001337340708276534,0.002722714127863816,0.01809201370876688,-0.03542306722847904,-0.001374702018687731,0.06882181222110101,0.03822595760634204,-0.004185905655608254,-0.04032221902545986,-0.07172959546390774,0.06362433828094453,-0.3274829482777012,0.01061472202348718,-0.02046699946370065,-0.0002733291052770137,0.01504193482763338,0.008724207551152097,-0.002005569029328662,-0.00442697656108866,-0.01040533694726208,-0.0005269842355195074,-0.0462863220683677,0.01384028241215062,-0.02907727153049029,-0.002420805579600158,-0.002929286408582238;

    // Trajectory SBAI: Version 5
    // K <<
    // -1.878946810475763,6.348892151873177,8.464588034469536,-18.37466895084684,-2.534695413723835,0.09526840313796192,13.14151698949459,1.144040049714604,0.2625329440532412,-1.281553842375263,-1.149097137499889,4.412357339336969,4.629568797712294,-4.546986990771754,-0.4128127648339728,0.08161850717203692,1.487151217247602,0.086916400256248,0.01067812623911549,-0.05159382868224444,-1.217078291865764,3.873630957663114,5.812645249422202,0.1526813850927284,-1.499582588513687,-9.079079247598681,7.82813826964015,21.13489979791891,-1.66121132654186,-0.253368729127894,-14.0359713361632,0.7432210548786845,-1.257419506995721,0.6580807527818635,-0.8557574530188362,-5.992735377253084,4.962940658515224,4.925879749474697,-0.2481549582877767,-0.09338909265008688,-1.555830196797994,0.05005172399759977,-0.05117730760739077,0.02158334060284175,-1.056584930592315,-5.696617171341141,4.651366229291743,-0.07130678128985037,0.02169593407988342,0.01983315515558326,-0.00209555091053516,-0.04877335600625726,0.0531735804021027,0.007149533040271678,0.03152416660697221,-0.07791017578615425,-0.2829668859804446,0.05341369195195403,0.01405447845915931,0.01295515439328963,-0.002683106106400142,-0.01160922452539789,0.01278714013417653,0.003391079067189266,0.003621514256648561,-0.01144539949233236,-0.0460035460440073,-0.0004984545095319229,0.0135586121620117,0.01226904640033963,0.0001975154535373974,0.004241972847393589,0.02115488532609293,-0.01956819069930618,-0.002895308375854289,0.05006848369664399,0.05236008915357428,-0.008770890251405265,-0.03221304893341739,-0.07787666780604616,0.05182019551918138,-0.2823076331769211,0.01390316015325594,-0.01338391656146687,-0.001456912734035685,0.01180677736714333,0.01259174454586035,-0.003569844031847242,-0.003673929140584024,-0.01142101774714589,-0.0005377442647083139,-0.04598174296824504,0.01295896500877169,-0.01232128313356206,-0.002324154057211891,-0.004880884168659809;

    // Trajectory SBAI: Version 6
    // K <<
    // -2.003016417700533,5.968108644823658,8.930179492527147,-17.34802084978898,-2.51747584560715,-0.6595811812206707,12.57615886635157,1.267431924111368,-2.817242002458967,2.587563100093591,-1.099512398998288,4.195096432829621,4.936837722933433,-4.425048823304213,-0.3509436945351829,-0.2337655730615289,1.616820840167746,0.08835294408095422,-0.1048129487549837,0.1078213925982398,-1.207421247278436,3.782790969013464,6.208094712246463,-0.4100418482349309,-1.856782728769011,-8.738175638600527,8.609982939332111,19.84883497972309,-2.005988661565937,0.2857231758567895,-13.44752792789911,1.042856576490229,1.423859635942814,-1.057513663405799,-1.010070478112341,-5.688790463373232,5.433862870118959,4.751901416190859,-0.2729373399436354,0.1401523874738913,-1.671348446321367,0.063140792017659,0.07775861804096285,-0.05587221479081949,-1.303927563554357,-5.421990803582296,5.298357973458926,0.1662556248071894,0.005189932043909682,0.0209702549914628,0.000475219419958618,-0.05198043191371771,0.01538287104945701,0.0006027556342547326,0.03407369492568114,-0.05775451486531302,-0.3447863558627831,0.06876604865192389,0.003697246077579709,0.013896299469889,-0.0007844302621419537,-0.01265789718327488,0.00431864379985685,0.0003553614779789806,0.004433981211873643,-0.009271998718064181,-0.04673728251903552,-0.0002589033261112969,0.003199372183129284,0.01319026788978275,0.001611298123779542,0.0002082726124442318,0.005556445623485548,-0.02168009990133924,-0.0002206743493797524,0.05350658578897613,0.01666985421941302,-0.0006179191371645926,-0.03477092715025965,-0.05888320875676917,0.06925894544840318,-0.3443067351219391,0.003906770731736087,-0.01444619888096486,0.000733558317562856,0.01296615795858405,0.004497588431497052,-0.0003588047714885827,-0.00450003512912205,-0.009364855592398674,-0.0002459027345765162,-0.04669368713477677,0.002854939727143234,-0.0137396773349314,-0.0008897738821467905,-0.0002147436319169771;

    // Trajectory SBAI: Version 7
    // K <<
    // 0.1080091281988629,2.368117945326445,4.816742514015146,-19.70618388207283,4.999629719075644,0.1235624661213832,26.04167746880532,-5.831095752202375,12.20207549367708,10.00970373992056,0.3965097378634526,2.686841015747514,3.553545228881033,-7.341669071228158,2.122083265498508,0.07661737851401049,2.771305401790939,-0.8000108914697046,0.3204987171083419,0.2726119702003862,-0.09117541419147852,0.6926154428480548,2.697579012622342,0.07111053339952286,0.3067364990243117,-3.550444356508722,4.528098705083627,19.97634343648923,6.773925918904093,-0.06593414755851111,-26.6328763262126,-8.154532414938815,12.91086618300161,14.28546990619817,0.622606525242239,-3.643221843719627,3.500924393646767,7.357890437487046,2.860354725640422,-0.06023330043101609,-2.7895166158267,-1.065628275061348,0.34061399658974,0.378818799703484,-0.04577334692860726,-1.640301720515735,2.532451209698578,-0.04716266215175586,0.0003811181928915184,0.007821015470311153,0.0006223975742093984,-0.05305609556663661,0.003325772020587494,0.0007860212435445854,0.06895386427217451,-0.04966443309722195,-0.3351250333787689,0.0652760645136839,0.0005053912459118738,0.008429351703827359,0.0002058594870656693,-0.01966635499560731,0.001600739567217343,0.00071475204385868,0.00740102758182183,-0.008734761874154643,-0.04632713530068577,-0.0004404873416807321,0.000180662400817184,0.00307076648422538,0.0004004791005057049,0.0004346352599336251,0.0008636907717642608,-0.007881487666581116,-0.0001170980540353097,0.05281609663160685,0.007659162128352748,-0.0008016641690857248,-0.06859563586775939,-0.05606593563175123,0.07005528812771658,-0.3302450990688254,0.00105715521533797,-0.008399364088410138,6.168055968999988e-05,0.01958071126061353,0.003389354890605961,-0.0007258517158725734,-0.007358804835460309,-0.009399366832096842,-0.0003243281558910215,-0.0461814721847091,0.0002869670048936878,-0.00310540625825231,-3.842227481707614e-05,-0.0004418158720937556;

    // Trajectory SBAI: Version 8
    // K <<
    // -2.118338219241861,4.901281575748572,9.038756105941914,-15.26805533999145,-2.498764973236172,-0.4169263801742344,11.3918111694295,1.120947495573242,-1.807029643831748,1.13260771444292,-1.146407503432633,3.606425520788832,5.097969159878357,-4.010033611707219,-0.3720277550364876,-0.1791750923690816,1.505463700454966,0.08688688156843424,-0.06645874271803688,0.06370927397923494,-1.224612507641921,3.150289423490047,6.222791104541171,-0.2907964141526388,-1.823787198304121,-8.015086729067301,8.770360441351334,18.25201078756631,-1.541544467758866,0.02379883464383672,-12.49715681924176,0.6727449525056213,0.186590061897768,0.4404263621807854,-0.937986082087545,-5.262891145254983,5.520544631481438,4.432355905213539,-0.1812272597737919,0.07604491905209067,-1.583428375981736,0.03381012360552383,0.05247023796993795,-0.01096789166980008,-1.246204158291423,-4.891780590447143,5.531847030053317,0.005349683188309702,0.002496300263030688,0.01811341121291247,0.0006305355290722278,-0.04641962344750765,0.008481206073695348,0.0002749891651585196,0.03087078659575875,-0.05474434989148147,-0.3598108604065876,0.06930775985523094,0.001931068691987664,0.012334268974826,-0.0005472339081999202,-0.01157844839297511,0.002603673614157367,0.0001371554071060006,0.004152890354687544,-0.008871230063557554,-0.04715698406181332,-0.0002264884247387798,0.001659409305625918,0.01134205726508134,0.001260657534451689,2.823471503713578e-05,0.003331360165021035,-0.01835229467589054,-1.39007989516271e-05,0.04675388927622734,0.01098751597849294,-0.0003427535985151246,-0.03090096304706358,-0.05649389081846016,0.06952311593008895,-0.3573509612351846,0.002482679318320225,-0.01248642205503651,0.0006923353049173086,0.01161506283742398,0.003079278496944886,-0.0001933793518117821,-0.00414104222782867,-0.009037473844284834,-0.0002293826678698538,-0.04703525849721697,0.001586763228549986,-0.0115013823322815,-0.0006142857282393578,-9.642233081558038e-05;

    // Trajectory SBAI: Version 9
    // K <<
    // -2.361789707606061,5.738355089962133,8.991814428756706,-17.36465545954109,-3.061040331177491,0.1026816203911365,12.54247860616245,1.393176266921429,1.647682043160752,-3.428439305317229,-1.365948677033685,4.100596104087223,5.145814243146486,-4.305816937322682,-0.5195714071089008,0.1362637747257518,1.420652021667615,0.09884881440870853,0.09537814246922389,-0.1658631740123627,-1.450605640278533,3.587253503325586,6.358953857887412,0.07969017174953191,-1.999511397589642,-9.034949014621565,8.687419726177126,20.72305015181816,-1.948158802927485,-0.6037038580110898,-13.78435670311549,0.7631608085227201,-4.46863876298586,3.789977594587316,-1.035618879586869,-5.907551260810581,5.490603020377214,4.831379522660468,-0.2795934959442027,-0.2335260460240149,-1.527950640340795,0.04345624305496484,-0.184654862779844,0.1513107734116487,-1.356509135439613,-5.553953728682357,5.450270244311299,-0.3259081351977562,0.004811546733412303,0.01925948191367835,-0.0001340909644826555,-0.04922285363772078,0.01463890638236302,0.002782827889769782,0.0321005684415071,-0.05881882255373164,-0.3349891305057596,0.05431792945602848,0.003242798305200351,0.01293595544788217,-0.0006716243261491829,-0.01176482319530979,0.003998242531306199,0.001566834110006874,0.00373431346046545,-0.009323811089617532,-0.04641038733606916,-0.0008734604802387685,0.002857937119834656,0.01190447971171136,0.0009449903231606853,0.001563188607308856,0.005411191282872971,-0.01971700420145774,-0.0002831708776476206,0.05043722454260069,0.01673225144814402,-0.003119382398733088,-0.03266493852227198,-0.06064919661791551,0.05277352425978294,-0.3317497132514001,0.003906433640668661,-0.0133686207782345,0.0004510637700689007,0.01201512888184069,0.00445681646013304,-0.001675704030100082,-0.003788169322442121,-0.009461344794144467,-0.0009315935882668027,-0.04626393671155046,0.002870046500912091,-0.0122809248913837,-0.001047721249181665,-0.001677932925349163;

    // Trajectory SBAI: Version 10
    // K <<
    // -2.30546305546602,5.503557925320456,8.903733045017907,-16.57881129454128,-2.904732014195837,0.183625223423688,12.13937635717221,1.280856878012214,2.164214202339726,-3.739004714823181,-1.323623067299648,3.916535221062893,5.104178789309247,-4.139782783450105,-0.4765638525041606,0.1667861564480954,1.383108199513191,0.08818262826000761,0.115741612841588,-0.1811050688474076,-1.403017057167915,3.399381628096167,6.256610199912726,0.1107796151311385,-1.890087786352539,-8.768316582606502,8.64779240881238,19.87748377932896,-1.744097600840181,-0.6713850101464917,-13.38997952790852,0.6349269452453179,-4.659526152481618,4.202624400096417,-0.9730407258658971,-5.705159848498766,5.449888432876334,4.665650294398148,-0.2309384154527721,-0.2570630964676453,-1.490732629692241,0.03084999885216809,-0.1950759163096583,0.1671367062871997,-1.283724519520015,-5.343342635327805,5.394050944407891,-0.3499563732122043,0.004671105119657881,0.01864608014011501,-0.0002040875250659396,-0.04720418481168086,0.01439388870350052,0.002876553979941787,0.03113028949778947,-0.05872323652450035,-0.3350436080902434,0.05404547392934302,0.003172499589408247,0.0124573929790031,-0.0006871249063433612,-0.01135977762096844,0.003957362036122181,0.001592731375422918,0.0036446682592501,-0.009310679077119351,-0.04640571737560432,-0.0008866596976193444,0.002755445777901796,0.01140568685970314,0.0008811634130648942,0.001555742422621352,0.005435018861865534,-0.01899981535121767,-0.0001935130992667135,0.04815579308007422,0.01660902556748587,-0.003316913370772131,-0.03154694669956763,-0.06056565766204453,0.05089878090796635,-0.3303065903620775,0.003902954641174357,-0.01281774474775752,0.0004373614162387521,0.01155161517437035,0.004419116800779995,-0.001775463449823357,-0.00368073183998092,-0.009448646798529315,-0.001005295908079092,-0.04620234599671699,0.002856251363705339,-0.01172323917424136,-0.000969986806607695,-0.001740888538534836;

    // Trajectory SBAI: Version 11
    // K <<
    // -2.362027482557058,5.738294606102267,8.992396135097549,-17.36464699777517,-3.061243833089188,0.1028935467684975,12.54246362866229,1.393230437582726,1.647706337948137,-3.42860193617545,-1.366058833174069,4.100590517835485,5.145991443746146,-4.30581050797331,-0.5196423034574021,0.1362860950977626,1.420649266150723,0.09886981046939589,0.09536988942883158,-0.1658632351116669,-1.45076692997342,3.587201418516938,6.359221038349268,0.07984739818089102,-1.999625524545751,-9.034918016328401,8.687846275496325,20.72292479550541,-1.948153202449022,-0.6034619401511533,-13.78429742733362,0.7630945660559849,-4.468052138983234,3.789404537424546,-1.035664124928222,-5.907514508521179,5.49072331067359,4.831357308533121,-0.2796213807601757,-0.2334855808225431,-1.527946548659535,0.04346623513633474,-0.1846341730127145,0.1512898866008294,-1.356576056850243,-5.553928705361831,5.450441522346286,-0.3257868595376275,0.004810656158386872,0.01925920400249443,-0.0001334203827781815,-0.04922256168839154,0.01463710910992881,0.002782846166559064,0.03210046944335764,-0.05881783842499276,-0.3349930432813097,0.05431953156186815,0.003242289544952637,0.01293584829990882,-0.0006714053637906725,-0.01176477408686163,0.003997799241565106,0.001566740542072475,0.003734308405994628,-0.009323663215186831,-0.0464105237581891,-0.0008734153000156584,0.002857401592570717,0.01190427791323229,0.0009452858113919606,0.001563196046968214,0.005410892660835263,-0.01971725512988041,-0.0002835105949318869,0.05043785617379396,0.01673136599328712,-0.003118884422538327,-0.03266526254753136,-0.06064870032312748,0.05277696622930676,-0.331754778563152,0.003906219751157551,-0.01336878975000231,0.0004509400507141007,0.01201526381137662,0.00445657063181139,-0.001675474867155538,-0.003788207727331966,-0.009461243773807308,-0.0009314760918742077,-0.04626411565710442,0.00286993360249282,-0.01228104072361955,-0.001048033915266865,-0.001677873256753698;

    // Trajectory SBAI: Version 12
    // K <<
    // -2.301875369967447,5.649050001176158,8.846444158011998,-16.38442208015353,-2.9305344294881,0.1595645002204035,11.25168710751406,1.284003570656763,2.378574011939166,-4.014821651625942,-1.336458322441972,3.944385871126692,5.062520078783459,-3.975528558674004,-0.4950370733840757,0.1698577536108976,1.29077497652778,0.09044508104342885,0.1333266843040283,-0.2062851643236703,-1.417579056168074,3.583106492706813,6.298919634415827,0.1233489217876692,-1.930749504526475,-8.9232521524484,8.640908526658151,19.79554178133476,-1.856842171628275,-0.6621508568294825,-12.54835075191167,0.7424532774105679,-4.885620515740896,4.391150864859033,-0.9867731919426398,-5.75381633508455,5.460523664954905,4.514857785814491,-0.2482524372543742,-0.2641440360635805,-1.405760406248963,0.03646739492025294,-0.2140470525120383,0.1855403169202622,-1.304823526529214,-5.534341739046417,5.438717765192734,-0.3523714422061014,0.00478580727043698,0.01885324612771135,-0.0002260009930484569,-0.04641479337550304,0.01461100848864592,0.002968585924818068,0.02862307730875388,-0.05868407456576466,-0.3334575180607374,0.05255530045336792,0.003339823305359485,0.01245218911993628,-0.0008502247927131097,-0.01085930185418166,0.004069840056408212,0.001646891851878997,0.003387988190476204,-0.009357904100643374,-0.04633625695680028,-0.0009557122387737274,0.002890785031500563,0.01177511809967047,0.000946946955533811,0.001652828804719252,0.005392619528579254,-0.01941149053082812,-9.155377820736733e-05,0.04772643079415238,0.01652612753010648,-0.003327478284223118,-0.02915464101321137,-0.06023235963013325,0.05009426836912213,-0.3292957842149026,0.004034352696485946,-0.01290390360459348,0.0004193099939079522,0.01109503839419511,0.004528670182602513,-0.001801347764799429,-0.003432415986876517,-0.009486987939773274,-0.001058286933043386,-0.04612877258534848,0.00293076148225842,-0.01223617390342174,-0.0009009058177938608,-0.001814956184062776;

    // Trajectory SBAI: Version 13
    // K <<
    // -1.410644876936636,5.747863627384524,8.105273298844555,-16.27286347174304,-1.571331414582047,0.402383024864866,11.18704080247015,0.7680459075991901,6.183464542911523,-6.133142118775837,-0.8941819424007832,3.935937098926656,4.593614508829932,-3.946977169253062,-0.2148590644431097,0.2822970488215671,1.278737839526803,0.03275967709786567,0.2945705387710876,-0.3388463578829379,-0.8848802131536095,3.546749818747785,5.795512422831224,0.4637750556589744,-1.086511450659916,-8.725185033097386,7.863065775937418,19.58471697184204,-0.7015673277272734,-0.8703246545339119,-12.41848014901232,0.340712027007651,-7.070959704005831,7.769694139930885,-0.6098340259990341,-5.694895832644369,5.058152719806617,4.46304497024026,-0.03805277209358814,-0.3653888601472155,-1.38832701355997,-0.007808505079886617,-0.338577896892379,0.3210335495859585,-0.7694909491819207,-5.494641998722911,4.912644080470213,-0.281922524391245,0.008146672168666788,0.01897641591321462,-0.00204490299252331,-0.04571253744060954,0.02215551133804996,0.004196578310351176,0.02806253421942251,-0.06199397206858685,-0.3072086216284036,0.04404576731994245,0.005398960798811516,0.01237443167584277,-0.001808219024522106,-0.01066521977509591,0.005951378511316051,0.00222902847680951,0.003300092749914402,-0.009870796019869546,-0.04581086886845748,-0.001255535041120052,0.005006710520927817,0.01182701919184471,-0.0004385375643428105,0.002370922494357993,0.008168838332792359,-0.0183281565054841,-0.001763807027985461,0.0456754187643067,0.02267944332752222,-0.004872596931432479,-0.02804014842212784,-0.06277401802719994,0.04359832379099818,-0.3068285268462459,0.00565866636385092,-0.01232171830169166,-0.0002994264430723842,0.01062456131995775,0.006046191315633342,-0.00231979507908686,-0.003291733044552642,-0.009920952510178858,-0.001239621498182079,-0.04578381075009794,0.004741845943000767,-0.01155596020535585,-0.002102803100106176,-0.002634108389988603;

    // [NEW] Nominal: DLQR (Gain Matrix 1)
    // K <<
    // 0.00414456380496133,8.11136305886915,8.41313385295402,-17.49009734557137,0.03884272320082232,0.09258972750432665,11.88735642637002,-0.03645655988815859,0.2237312182903165,-0.2221868791178601,0.005071678526108874,4.873638631494416,4.503750039600542,-4.157489609137243,0.01994708498389753,0.05677097612365792,1.398760170139097,-0.01830329024083419,0.005927831128726092,-0.005895975476932722,0.001770761808318394,6.33781955679348,7.271306882623498,0.04639082194174289,0.001479453283696245,-8.056698500614862,8.438805229800392,17.3822122669957,0.03480768222651218,-0.09195879240906792,-11.81603523512406,-0.034132155911909,-0.2219344314915408,0.220852912720424,0.003699815211566069,-4.841665551014458,4.517487651974221,4.135402784198546,0.01924643435568643,-0.05638946466427856,-1.394308843830499,-0.01823369064629,-0.005892852075749529,0.005854084142386696,-0.0006089115524787227,-6.294587662507691,7.292992696560136,-0.0460728723727048,0.2693039402633017,0.003508992975440524,3.940599376324039e-05,-0.004547530733410507,0.5463109890624445,0.04717157461107596,0.001454224292652364,-0.354045892210166,0.2326515090506454,0.04607574499198084,0.1574035091380305,0.001707840470645041,1.922347015508599e-05,-0.000608387172317737,0.1240057316118414,0.03161857284639639,-8.939772449888035e-05,-0.03957472284554019,0.009490394423511437,0.0005560272273431611,0.2156152402616979,0.00325079132374201,-1.896320010522828e-05,0.02274911903033843,0.2691776732312057,-0.003534642223849411,4.51953031295856e-05,0.004619018931209935,0.5463822708190541,-0.04729642938592719,-0.001521720831485687,-0.3542482493845015,0.04584150892675178,0.2333699675305693,0.1573757785193979,-0.001725365257137867,2.264519556502062e-05,0.0006278876730329311,0.1240671202705819,-0.03172496563133279,8.081238599611529e-05,-0.0396052206093329,0.0005540189670809296,0.009510803731722651,0.2154498875667861,-0.003268317748465747,-1.468226476986434e-05,-0.02280200423955538;

    // [NEW] Nominal: DLQR (Gain Matrix 2)
    // K <<
    // 0.0014893519369371,4.061788779933305,4.559807258197124,-12.88625801882455,0.02172646787885307,0.1020716808128529,10.26509783208376,-0.02063577421806156,0.2352149646078597,-0.233818426554257,0.002244171737548456,3.075622689251715,3.337782827648789,-3.438616869349283,0.01430837103621179,0.06351002395160119,1.258924492787279,-0.01351509228639351,0.006065603000974811,-0.006032261649190458,0.0004821840703890911,2.019222173574238,2.313140912977175,0.05083944263021112,0.0002076110229850251,-4.034228737905644,4.573604848824997,12.80452197982978,0.01883159533554796,-0.1013676333685311,-10.2004050772937,-0.01852991401040921,-0.2334207641701095,0.2323198403510006,0.001406907803778056,-3.055136228968907,3.347953040191561,3.419616419310854,0.01373845364572163,-0.0630773506971519,-1.254074858150308,-0.01345240858546781,-0.006026008720833413,0.005991027048224027,-0.0002111821812927922,-2.005429151322157,2.320058054982966,-0.05048709508966769,0.136049305928486,0.001385089516794732,8.135154763515118e-06,-0.002381300582014796,0.4071727144962082,0.04719565638444072,0.0007151391673772292,-0.3081320198953078,0.2241160777344016,0.03753390019925542,0.1003658882276325,0.0008222160938505227,1.297992867315882e-05,-0.0002781501975431984,0.1039715937178945,0.03163605465355865,-0.0001529981210652238,-0.03603110312940775,0.009288802460410483,0.0003545853261990669,0.06869880736442047,0.0007830803432291835,-4.540509020291195e-06,0.02276029248791381,0.1360283057596919,-0.001396428454050286,1.146344759375547e-05,0.002429209899402142,0.4073257354034732,-0.04728094336054367,-0.0007710842571356382,-0.3083589673978348,0.03730061478649755,0.2248419877340015,0.1003763102583151,-0.0008321122153759192,1.563103328973702e-05,0.0002930741915217779,0.1040439519381389,-0.03171359684940416,0.0001454046928393673,-0.03606346067401808,0.0003524124391279764,0.009309568013945448,0.06867681130133139,-0.0007881877655993463,-2.973414693278685e-06,-0.02279486241909791;

    // [NEW] Nominal: DLQR (Gain Matrix 3)
    // K <<
    // 0.001566230670514762,4.061864781066866,4.559807301247051,-12.88575508665283,0.02191189921336189,0.1152062480572338,10.26434582263245,-0.02077704745141087,0.2688213705169554,-0.2674032751151511,0.002295581656536923,3.075595844919545,3.337782845844702,-3.438354412246,0.01434852858250306,0.07199437438902649,1.258732241169154,-0.01352687996574181,0.007539857083596965,-0.007505578501578183,0.0005233198548467641,2.019295361297516,2.313140939206405,0.05728466674358053,0.0001358642789502017,-4.034304565385275,4.573604806431589,12.80402317892951,0.0186640267259364,-0.1144210498632379,-10.19965853225213,-0.01840218468042393,-0.2668047464603246,0.2656990577482665,0.001359583905168844,-3.055109785480719,3.347953022544428,3.419355864110515,0.01370303460260221,-0.07150926428825564,-1.253883910933518,-0.01344288219947916,-0.007490627953614764,0.007455400081378986,-0.0002498498869007503,-2.005502029023421,2.320058028890007,-0.05689249240668383,0.164786208815635,0.001230703287835571,1.024122966072687e-05,-0.001644391414819698,0.4871575417168472,0.05200038367679195,3.677240043384107e-05,-0.3651669073022307,0.2601567232632442,0.04388058596913044,0.1209022148993849,0.0006772429356878006,1.596270970618787e-05,-3.903283977840589e-05,0.1232271032513456,0.03475260686620749,-0.0002709329023980811,-0.04135677824260359,0.01050744637925368,0.0005078048672237307,0.08347984398308114,0.0007181261725847663,-5.36724594567158e-06,0.02511321345898146,0.1647773698059822,-0.001240710504546552,1.354282037788858e-05,0.00168849695312645,0.4873663370011361,-0.05213512386194114,-9.113438881859478e-05,-0.3654185765437854,0.04353429926615918,0.2611041211637787,0.1209240017713799,-0.0006861820722416546,1.860337334729721e-05,5.297255254830012e-05,0.1233164177983979,-0.03486703619023303,0.0002637271010400498,-0.04139401456886622,0.0005034868260043182,0.01053316057547581,0.08346291202927886,-0.0007225497045950069,-3.81730218402948e-06,-0.02517039879785551;

    // [NEW] Nominal: DLQR (Gain Matrix 4)
    // K <<
    // 0.001680383805595857,4.061732706102058,4.559807354298968,-12.88454637800175,0.02219678781810643,0.1295472678473133,10.263038165153,-0.0209921451265045,0.3088266830506944,-0.3073495166121629,0.002373114412135209,3.075406184918917,3.337782872642069,-3.437896009997181,0.01441191556051623,0.08127704345413347,1.258463795263784,-0.01354461423436379,0.009165860726852429,-0.009129194182926419,0.0005838536095889779,2.019267348849125,2.313140967125619,0.06431531844608367,2.827256742362904e-05,-4.034173629631107,4.573604754197565,12.80282308642223,0.01840015943835042,-0.1286723683705805,-10.1983598851684,-0.01820251030108161,-0.3065447799020319,0.3053976793972717,0.001287061525166529,-3.054921556998372,3.347952996493447,3.418900615433045,0.01364504514901023,-0.08073385094893726,-1.253617258966779,-0.01342739983714762,-0.009105966626891447,0.00906903671451911,-0.0003071397533427389,-2.005474343719347,2.320058001075098,-0.06387916610656694,0.212826360757351,0.0009564372671143323,1.378806995649009e-05,-0.0004921735240245324,0.6206625886376739,0.05763922774472989,-0.0009732248595256907,-0.4590972046879896,0.3163771928751752,0.06242438864409855,0.1552052141604383,0.0004374728703749467,2.096418500963032e-05,0.0003167317961350556,0.1553433480834726,0.03841710648977197,-0.0004352404190882908,-0.05022083664318351,0.01232139090694848,0.001055112766105649,0.1082031548547836,0.0005952856212527476,-6.73903300154134e-06,0.02787229287954819,0.2128688291035751,-0.0009621727534798069,1.705534867519614e-05,0.0005227164741645306,0.6210408710492558,-0.05787847907443482,0.0009271006140085194,-0.4594455428265367,0.06180741077582825,0.3178021003690967,0.1552669011415714,-0.0004431787686547047,2.359226658257034e-05,-0.0003064674045830623,0.1554778384115777,-0.03860739280005863,0.0004294552918184498,-0.05027116913374569,0.001045311897807575,0.01235800046376824,0.1082111798214334,-0.0005975858093156471,-5.211972032658856e-06,-0.02797797225660767;

    // [NEW] Nominal: DLQR (Gain Matrix 5)
    // K <<
    // 0.001407722443165155,4.061405306620123,4.559807205493568,-12.88609333523156,0.02153622704649434,0.08397649314601686,10.26549872279995,-0.02049191821700348,0.1933026266033013,-0.1919188193476305,0.002190434859006414,3.075451525015611,3.337782809894392,-3.438754531236274,0.01426831476992614,0.05184655791105589,1.259112595198952,-0.01350223090917346,0.00406540980920072,-0.004032514419121157,0.0004381110393222309,2.01898157427105,2.313140876309833,0.04195127610934286,0.0002808705967556323,-4.033847190103256,4.57360490052742,12.80435684533872,0.0189912114913807,-0.08338217836260876,-10.20080235061977,-0.01865014398159246,-0.191787412901738,0.1906688896781586,0.001453804316357004,-3.054965776950997,3.347953057112374,3.419752843218837,0.01377023822816054,-0.05148463030762882,-1.25426164212547,-0.01346108674152911,-0.004038907059670515,0.00400309656342048,-0.0001710610059986878,-2.005189822527942,2.320058091431888,-0.04165284508510975,0.1073716285089597,0.001471439447662911,6.068954476323901e-06,-0.002983501811637234,0.327025938342077,0.04098171918571557,0.001330707068860389,-0.2501374365789196,0.1860060819152889,0.03426817479756505,0.07983194204283726,0.0009248232058538591,1.002399618265744e-05,-0.0004955181768331436,0.08462339721311475,0.02761475884934008,-3.235351308544587e-05,-0.0306213311651641,0.007933552310227274,0.0003498087067230824,0.05396608456308842,0.0008103913462103153,-3.701215169229764e-06,0.01971419571135192,0.1073521324068585,-0.001483041860609011,9.425014173233292e-06,0.003031494017827691,0.3271553975319423,-0.04102761078279483,-0.001385239333810192,-0.2503607747802775,0.03411578783778631,0.1865542748192164,0.07984004269956052,-0.0009348279260502485,1.268496340342102e-05,0.0005103850059490248,0.08468566627322915,-0.02766189773051473,2.476300518369074e-05,-0.0306509726242606,0.0003489542989344832,0.007950430119947964,0.05394637920234683,-0.0008156688413211498,-2.115282004038023e-06,-0.01973108895228992;

    // [NEW] Nominal: DLQR (Gain Matrix 6)
    // K <<
    // 0.001312550437015821,4.060230597387482,4.559807132948041,-12.88407638465586,0.02132286410522166,0.0553504436239379,10.26482003688348,-0.02033733953432668,0.1362019629261547,-0.1348425958195767,0.002128919120855426,3.074755569219857,3.337782794214155,-3.438511898506849,0.01422484355911849,0.03344839993525266,1.259250500404858,-0.01348478123109132,0.0009973919948607908,-0.0009648962667902284,0.0003861711805773989,2.018316577366309,2.313140816995952,0.0278720593340514,0.000352760064829666,-4.032678784585153,4.573604970716977,12.80234943181657,0.01911759351952715,-0.05492204872245875,-10.20012572154497,-0.01873749124355247,-0.1350779013795903,0.1338969112604962,0.001496077291918896,-3.054273403391795,3.347953070640762,3.419510989716178,0.0137900639116623,-0.03319309179687587,-1.254398425347002,-0.01346642497078411,-0.0009912659973867165,0.0009521795933860272,-0.0001300234333369751,-2.004528459790077,2.320058150409258,-0.02765530488923098,0.07469226409185419,0.001364330917748623,3.806526185050438e-06,-0.003147221520383722,0.2348494403251567,0.03168367765828539,0.001696351272176361,-0.181851942986317,0.139964907033102,0.03265771454691303,0.05633185123135537,0.0009006453407391038,6.708639089373524e-06,-0.0006268014893798235,0.0622214200230424,0.02161796714267156,7.973482796817225e-05,-0.02417888662251585,0.006169879697257432,0.0005227567780594065,0.03722173799846154,0.0007333277411204679,-2.706848438782182e-06,0.01514985155954181,0.074688254644813,-0.001374719349100909,7.181782784419934e-06,0.003190032220411151,0.2349811238731713,-0.03169700763591024,-0.001744785645294106,-0.1820828962221018,0.0325693433332393,0.1403561470305632,0.05634600592010891,-0.0009095712845811511,9.372158948610788e-06,0.0006401266133942568,0.06227775951187681,-0.0216382807299904,-8.67677440330192e-05,-0.02420754402988893,0.0005225509530266304,0.006183351666891014,0.03721224132411889,-0.0007380705497341297,-1.103567313243987e-06,-0.01515269724557721;

    // [NEW] H2Hinf Nominal: Gain Matrix 1
    // K
    // << 1.832221629121883,2.947698644731909,7.583424080964162,-11.26322403301796,4.286378197497331,0.1542936000278653,9.783932457588678,-2.300299066504953,0.5902581616032825,0.3787322574860673,0.9815863818888105,2.266237770461723,4.035092872175543,-3.16513843073297,0.9303604710404032,0.03503045124825946,1.207802527752012,-0.2119372785577261,0.02526187326718351,0.005452744551694116,1.195654322643685,1.451567142193494,5.198389668553828,0.1775360793779316,-2.88052478813442,-4.99436401967018,7.111125244954382,13.34157391831335,-4.41604856715113,-0.1811898378619178,-10.1861938221822,1.818070762886491,-0.3601471806090616,-0.3638714626505594,-1.730123657338973,-3.608717623456724,4.395563101089102,3.389061314492666,-0.776183662561909,0.02712984897963822,-1.241999514807207,0.1410004294781059,-0.01398035776836253,-0.01050254767833316,-2.119987926715885,-3.067831732076761,4.313226860655366,-0.1574546222108483,0.09884699983129816,0.005535777356680653,0.003870432325984183,-0.01871937445224953,0.2561129097432304,0.03006822446025059,0.01537120537318562,-0.2023495507410001,-0.05655931856143039,0.09130117702713879,0.06700592310247562,0.003941721718237941,-0.003528090153035363,-0.0051457709143624,0.06221954889581036,0.02341975568932718,0.001780431435251972,-0.0219825216773869,0.003288585523029749,0.000333694128061061,0.06090560323474052,0.00335120918700036,0.007311261067815177,0.01128541184305718,0.1032817176647338,-0.01167732412675472,0.003491783520969928,0.02820444987900163,0.2625771831683298,-0.02371214490718454,-0.01848045778968647,-0.2029371677381446,0.08007636972397802,-0.04464138242473545,0.06928256890578566,-0.008006706222856945,-0.002975540971597219,0.006427056687260252,0.06354667122581426,-0.02263114328804878,-0.002029803822602239,-0.0220812331850777,0.0006734740745002366,0.00295020676915528,0.06410046198324992,-0.007067242879591072,0.006317357812956313,-0.00643282684514059;

    // [NEW] H2Hinf Nominal: Gain Matrix 2 [THE BETTER NOMINAL ONE]
    // K <<
    // -0.8355260857979369,4.339651897716738,7.690720637254041,-13.90490468760841,-0.748310239388051,-0.5984772953367569,11.00502662657605,0.1237495684246714,-1.041824353699047,0.6695760235988307,-0.5785951937745417,3.085739170310323,4.162522000197536,-3.687700122499866,-0.06082642149394126,0.009352004299532106,1.324178863406233,0.005144029300685703,-0.02307201879921557,0.01427231502790249,-0.6237355636295844,2.43020952821631,5.203505400343763,-0.1293935383648364,-0.6611473748508619,-5.545580662974738,7.100921436372446,14.36025289020542,-0.1863543487911806,0.6599545114943532,-10.6664323424555,-0.1829238567866177,1.189461113015053,-0.4228276625803573,-0.4266351147574719,-3.923351560832941,4.285371018566556,3.591059690614499,0.05384421320430927,0.001621691117778768,-1.288374877518599,-0.03736359302641765,0.02502207887737313,-0.01020686384483544,-0.5897734398898608,-3.425063003849616,4.361763751642638,0.1469166479137759,0.01647107688486495,-0.005695471763832295,0.003499350288159439,2.236983902124443e-05,0.06376855780193573,0.005190426387447222,0.008390050995138411,-0.08151391077984656,-0.1985827857605856,0.09219423297576378,0.01386699201479482,-0.001916909138350972,0.001385498128818477,-0.001966343026537434,0.01833749974381805,0.0018821355964789,0.001490001986538792,-0.008414944677444894,0.0003091045730434896,0.0007619505608023197,0.007881219505268003,-0.005241968117872455,0.002346184223331812,0.001002262311054418,0.01448862215564566,-0.0306185426759083,0.002410559092921482,0.0678617681121295,0.06069245746932696,0.00140585169063059,-0.03923260295632357,-0.08079186648478857,0.1043755954443508,-0.2106651135755996,0.01284455978846284,-0.01912428987424523,0.001967885118319594,0.01505119066300693,0.01775514537961228,-0.002615473085961117,-0.004406711745991151,-0.00827380078913865,0.001000497629480794,7.169402374774866e-05,0.00625281995769159,-0.02038848654406357,0.0002126487508011835,-0.001204744624103276;

    // [NEW] H2Hinf Trajectory 2: Gain Matrix 1
    // K <<
    // -5.085659049226589,27.1335190241948,11.77226926221015,-99.46613828626359,-11.01359928801828,-0.1316902930779533,44.65177489989883,4.236956587630833,0.2723994855797783,-2.371386210634503,-3.909284599057823,28.11588193099114,7.285894681643229,-18.67836826983842,-1.597493830609777,0.01412478576547688,4.219069099851263,0.2933718639744901,-0.00952715373013654,-0.04290567123045132,-1.863329867971416,11.45602816334227,7.287130900678129,-0.07850420776582638,-6.225512238347031,-32.34427059154424,11.06203790801511,105.0132667382405,-10.72596297699298,0.3701434777273648,-46.09416285498405,3.968355811821519,-2.181751115886737,0.2917805061721648,-4.310398447239764,-30.33612095816607,7.686479131232458,19.39319213240256,-1.507685631741702,0.003897665191215124,-4.361167411184742,0.267032441274887,-0.03730978422100337,-0.008587167009476775,-2.5025751699664,-13.49453198381597,5.7614359383167,0.2136926826363922,0.2246373508781248,0.1017737006878477,-0.001134343463237592,-0.2736032832756307,0.7560543660828527,0.01635054707649712,0.1115291192774231,-0.3927066171009644,-0.0739035862179558,0.1207352538020641,0.2125594553881151,0.09018241584478211,-0.009051579639188593,-0.04731281028533681,0.14452108850621,0.008734745945049477,0.009878395987932005,-0.03415597217447065,0.003307499403809781,0.001541940446804313,0.09238034258245038,0.04211889029252815,0.004982520361399102,0.009414068531135246,0.2087139076184227,-0.07667378781260183,-0.003448710199902972,0.2564344632284422,0.7411405489148127,-0.0202115778075062,-0.1066390924860642,-0.3892371626260616,0.1214353983409654,-0.0753952871819336,0.2036188664704033,-0.0802508387877887,-0.008660180757121057,0.04708327218275758,0.1432339783360874,-0.009019913067349406,-0.009722175136551875,-0.03395962917067494,0.001559284497037328,0.003302025772218778,0.08375519876180607,-0.03394904256551391,0.0007976154830405733,-0.01107260777667865;

    // [NEW] H2Hinf Trajectory 2 (reduced domain of attraction): Gain Matrix 1
    // K <<
    // -1.36010639619243,9.857597208646974,9.484677034260919,-35.03269299828498,-0.9123359272322003,0.04154930686559553,20.74568067379176,0.2185648570819487,0.5890948168307457,-0.7579888786478125,-0.7197717765309671,9.0231053456406,5.216058290298108,-7.678755682552092,-0.1574200906039089,0.04090478084424682,2.177687506463297,0.007769790091709314,0.006233948871581664,-0.009834542967678475,-0.8624221825484514,4.672493678313643,6.22084247926549,0.04980619388337132,-1.319261394243493,-11.87314538802141,8.589554413657916,35.70150219410184,-0.7345137705041388,-0.07596353543578693,-20.77687713183633,0.1237846513126621,-0.8227065767344184,0.6456237124327062,-0.6529533036659279,-9.842106850466701,5.197138650784644,7.746737245699701,-0.1297816121021693,-0.05504325154275975,-2.182863744689386,-0.003446378970262275,-0.01071722209838495,0.009730096403919822,-0.8150553798200917,-6.087545097006201,5.240189633180751,-0.06126528221113593,0.09205888536356818,0.02375619637190363,0.004526193938390835,-0.06796006606930367,0.3031099497584637,0.02169022832833008,0.03801765319938682,-0.2111580192119827,-0.1146605588933853,0.07676028491566327,0.07912431659164684,0.01965579214272366,0.000116643370449607,-0.01417547909270974,0.06649137257921693,0.009520938882688587,0.003778073989048664,-0.01959399740640169,0.002392875652065422,0.0004272126414664847,0.04548897941425793,0.01172552692728479,0.004958804505960053,0.01291402516804147,0.08875456526037855,-0.02456303592941031,0.002476559129430608,0.07069736449039549,0.2992068138376855,-0.02319942421025123,-0.03879666908537537,-0.2098867111342185,0.07511782146536683,-0.1145569455330682,0.07732343942170382,-0.02095090578499786,0.0002232401955850214,0.01483749154742687,0.0661593826525631,-0.009777110493609629,-0.003825401079366186,-0.01947555603345768,0.0003942825287153818,0.002399572191853269,0.0432199011894216,-0.01240513239883714,0.002899879366022335,-0.01358485186460191;

    // [NEW] H2Hinf Trajectory 2 (reduced domain of attraction): Gain Matrix 2
    // K <<
    // -1.613445983287936,12.77221089294331,9.123600291900155,-46.53809213328609,-2.459907396589904,-0.2195669929179283,24.86890920753459,1.042150945902514,-0.1404747033269605,-1.763738439840025,-1.051231800509925,12.55559428283206,5.108554613725183,-9.528836126320293,-0.447634448849775,0.01447382784291626,2.526331285485325,0.09418287188887865,-0.009867558963562504,-0.03866054434443298,-0.9708223605021352,5.522053661185264,5.983161978865377,-0.1080435454118631,-1.443182752025176,-14.05910370256863,8.474354766803568,46.48175906278789,-1.484543672280788,0.07698454188008834,-24.79200029794991,0.4123621120085081,-1.584291516814079,0.2488126941876581,-0.8121736359220445,-12.98333597971865,5.124338411463962,9.561003226453305,-0.227998453860199,-0.04746129740091947,-2.525924720604802,0.03091139716841676,-0.03765537556637353,0.005378588535471511,-0.8520172045669985,-6.522345937917704,5.183765067698626,0.03340235011507603,0.007227217572188514,0.03665097357014695,0.0004814987633081145,-0.1249999989155056,0.02902088362627532,0.002767389319048304,0.06499249784194801,-0.06367984458084903,-0.3203001883577278,0.06880154440419811,0.006456033164261549,0.03473746238238717,-0.0003190410936366705,-0.02559205231254494,0.007510369990162043,0.001750150707987936,0.00669808132870946,-0.00343136218567994,-0.001341293351695593,-0.0002364868675891661,0.003253503497547929,0.01645510660506717,0.0008826945039814491,0.001618795400614299,0.007536034687064127,-0.03611803614485896,-0.001083667960137538,0.1234722041896492,0.0322345779475761,-0.002876864615755078,-0.06416414868278526,-0.06647182238508736,0.06975732807050365,-0.3191265155024518,0.007129660002016106,-0.03428992969301244,-0.0002932134924201151,0.02524344394764301,0.008324487912441829,-0.001782877188259802,-0.006595957140635684,-0.003673073236573883,-0.0002135929443457352,-0.001286670090885245,0.003457468684739372,-0.01619397783049304,-0.001256902939663327,-0.001655694932549058;

    // [NEW] H2Hinf Trajectory 2 (reduced domain of attraction): Gain Matrix 3
    // K <<
    // -1.41743790954021,12.37857523179731,9.187363043285981,-44.69657159488339,-1.503923276499132,-0.06446984389289349,24.26078020058199,0.5539385523923436,0.3710095577768202,-1.377499203240893,-0.8380472898124305,12.10020555322494,5.185762970981838,-9.229638553872915,-0.2319956500020527,0.02995152662120538,2.470882818340052,0.0337021711058081,0.003230535159141501,-0.02820708562939218,-0.8966412035182908,5.235423100668433,6.012023678343886,-0.0334882584865696,-1.21158372515532,-13.41193562892566,8.454297609200989,43.64679738381381,-0.5465250408765615,-0.0418021948282053,-23.77979727908718,-0.04906770447422004,-1.185259578400556,0.6899342257921581,-0.5988585555465455,-12.24136407688062,5.025106307803717,9.073279418603258,-0.01883648054232922,-0.05987334164219585,-2.43414012382156,-0.02556426799760613,-0.02652765867156896,0.01685578224850213,-0.8012376544129659,-6.156540750272316,5.233546603496771,-0.02795588931228758,0.007004834019170293,0.03476413842233553,0.0004607110754427771,-0.1178001710432824,0.02862086190458322,0.003174181506947955,0.06249981084288446,-0.06358935318104063,-0.3202293795073886,0.06863430904084272,0.00631070079877687,0.03274890713134399,-9.966714981080176e-05,-0.02438892351054157,0.007455949592238849,0.001791842627950734,0.006470572573232583,-0.003420417179882053,-0.001341053414567047,-0.0002398056177713741,0.003167191064613344,0.01533706711457515,0.0007695059479331015,0.001824616524407243,0.007680519117921167,-0.0342628564057938,-0.00129799851983192,0.1164254938416958,0.03190638667236635,-0.00320874927412268,-0.0617216270106396,-0.06624987795783119,0.0696632605740841,-0.3193485348719532,0.007122560783213827,-0.0323575162445686,-0.0005508732839216943,0.02405823563518301,0.008237194027710389,-0.001806608066643184,-0.006373018884641054,-0.003645905939480768,-0.0002150776927472602,-0.001292938633973659,0.003488181205359488,-0.0150620679951875,-0.001276976986153685,-0.001835932776340151;

    // [NEW] H2Hinf Trajectory 2 (reduced domain of attraction): Gain Matrix 4
    // K <<
    // -1.77815446612958,14.25421297252991,8.979544816947001,-50.96635871001392,-3.079078886128951,-0.1508032150258579,26.47285303555091,1.320196399064636,-0.3469286722696749,-2.186194818892707,-1.209188734524893,14.04212516432467,5.044015594852189,-10.24145571464312,-0.5818162897301328,0.000142122024898896,2.661427178470954,0.1349218112585823,-0.009828503778409126,-0.05648681544467807,-1.062131947707574,5.735251331633523,5.891789998561662,-0.1086751548475706,-1.494923127138774,-15.42489443389648,8.509938477848612,50.9871456295943,-1.624523047249606,0.02903309802056086,-26.47031999561732,0.4527173929240369,-1.850031247613315,0.1183499621278485,-0.8549093195889994,-14.4268098749597,5.099830112582729,10.30275775234005,-0.2564792386440329,-0.03513170264331826,-2.669066951919354,0.04839696640102598,-0.05167943247232853,0.007397340826561978,-0.890346048511069,-6.633358241045823,5.193846136160865,0.03850118443383961,0.004922200320908245,0.04009788147532432,0.0002794250874724306,-0.1366555146839803,0.02099094829553106,0.002248974407112331,0.06948913144731475,-0.0592397294486866,-0.3282537569646211,0.06833697409076747,0.004448202125679705,0.03844943761791958,-0.0003040423691554805,-0.02755078398717697,0.005694892141998827,0.001405859796602969,0.007100655129232999,-0.002884653873517101,-0.001525905548719699,-0.0002664777747482675,0.002098422823663886,0.01667724302017241,0.000761726577425739,0.001202343491360379,0.005833062867147827,-0.03956341158230517,-0.0008339386203506198,0.1350668952068906,0.02574774880955983,-0.002267847716283483,-0.06867412578821852,-0.06272356090136626,0.06998968218822191,-0.3269380894443528,0.005600792040491942,-0.03798057388473466,-0.0001947532353354773,0.02720879792561587,0.006812013857445716,-0.001415197110452419,-0.007006224767484553,-0.003197881018849057,-0.0002265625328076924,-0.001467631187005891,0.002633777142898747,-0.01643431809468919,-0.001092637240606355,-0.001209780185909951;

    // [NEW] H2Hinf Trajectory 2 (reduced domain of attraction): Gain Matrix 5
    // K <<
    // -1.10531311118539,5.843407496774956,6.306230621337395,-24.14289257285609,-1.860370935170531,0.01868517287956466,15.12948256146499,0.7590710028795963,-0.04842509255349461,-1.231777227969011,-0.7974364052653308,5.872701063737812,4.323659507841395,-5.483253162386268,-0.3403407175354494,0.02883481172931996,1.691579707275383,0.06553901857447564,-0.009515531085009649,-0.02325579358517722,-0.5877498068397967,2.460125875469117,3.403788594487855,0.01868343432384752,-1.010220746888077,-7.021977345402339,5.855182124020219,24.94682395426304,-1.476198068927895,-0.03905846433154442,-15.30673739702803,0.5621014467525786,-1.213741220929491,0.06674342120877863,-0.6829641491683255,-6.467034109615165,4.420550622777877,5.59064320738539,-0.2705232695642585,-0.0389364942345912,-1.706608641582755,0.04489620458744156,-0.02276205196856105,-0.004346548246877132,-0.5125450191821639,-3.20910337368244,2.850652304658239,-0.01892371460031285,0.01387937994032018,0.01766895321704105,0.0006320038887961078,-0.06452007095234109,0.05609228401687869,0.005109277320220655,0.03837348022538285,-0.07868960897692659,-0.2937275064971707,0.0693534567510556,0.01305698759530684,0.01669035442104101,-0.000633832059359738,-0.01436804488814331,0.0136700700117557,0.002675030599904192,0.004333005703092445,-0.00525235882969409,-0.0007295561171417369,-0.0001787364444935165,0.006121587521667354,0.007764838552546485,0.001059055154695895,0.002939761162590385,0.01378905569389133,-0.0173284857289342,-0.0004255749529725688,0.06397759390072692,0.05720052892998233,-0.00529935561890587,-0.03795800826871444,-0.08000530790002636,0.06915101000989117,-0.2931018093637435,0.01325314194449306,-0.01656151717608738,-0.0003400313820861742,0.01423211165873305,0.01401055006642192,-0.002743347430232787,-0.004266946362708,-0.005347351407460336,-0.0001819071868255689,-0.0006894155586470592,0.006038351001914834,-0.007617018622276097,-0.0003612793496288572,-0.003036896757978095;

    // [NEW] H2Hinf Trajectory 2 (reduced domain of attraction): Gain Matrix 6
    // K <<
    // -0.6747489320813662,6.682614093331161,5.181933348617021,-40.54625749098322,-0.923088258526131,-0.04667540280166818,23.30938001651669,0.3881972140573571,2.808958842674534,-2.707197711240759,-0.6870451511021828,9.319144769601156,3.69558536829578,-8.834260813862157,-0.1739216559990179,0.1184337790886203,2.330561217372221,0.014780128777387,0.1140997219635985,-0.1072276695830941,-0.2863281978173384,2.105595380678236,2.771662826110744,-0.02046226848296847,-0.4755111544828324,-7.17053639650521,4.925023285794467,38.92355490309323,0.4904022179924545,0.02166116646115536,-22.74787563968111,-0.6936426783495145,-2.648381134943803,3.192704291655325,-0.3698553956634785,-9.562891375106377,3.348577147163485,8.647586148768202,0.2148983816824049,-0.1193134653637303,-2.287514045050815,-0.07935176453261988,-0.1042027361188142,0.119344887768436,-0.1992356916564582,-2.355303476314622,2.541899111403897,0.01441149261451595,0.0005298625923558178,0.01813050070534519,0.00029693407019267,-0.1047570862822216,0.004196394163927061,0.0003975892487269705,0.06000331378196987,-0.0500890728978911,-0.348142031923116,0.06148256969601974,0.0005242168760935593,0.02488290028883819,0.000395723665865261,-0.02321614923735302,0.001560118455615188,0.0008258125713947391,0.006153771916650628,-0.00157671632799132,-0.002608186427457439,-0.0003418825490844617,0.0001594090660004892,0.005816209642947366,0.0002579591097021843,8.391786369052814e-05,0.001083370098357252,-0.01795780574195526,-0.0003693767452132714,0.103789741609725,0.008258103866642687,-0.0003965083705324036,-0.05945804447261302,-0.05393350354523284,0.06278038569919164,-0.3476123489584205,0.001406955777824322,-0.02464825364777836,-0.0004906612057310766,0.02299370097215076,0.00271478733745258,-0.0008229028825507018,-0.006093849314448255,-0.001880705952687734,-0.000315634791808798,-0.002578746912731023,0.0004066322364217358,-0.005754291974849063,-0.0003544042007155443,-8.402910089311594e-05;

    // [NEW] H2Hinf Trajectory 2 (reduced domain of attraction): Gain Matrix 7
    // K <<
    // -1.074428984836413,5.687510386443464,6.340872506258206,-23.45665353940601,-1.666599418501471,0.0303173105713954,14.83753960133509,0.6600135692379162,0.006002186167348956,-1.127963345758865,-0.7572189867706042,5.682052473444093,4.345722142301168,-5.356509526806924,-0.3021117810840752,0.03044935934477109,1.664993848985441,0.05559065318710497,-0.008175772568861026,-0.02049414886041269,-0.5748866221235468,2.404756050466927,3.427756339337787,0.02624745174462613,-0.9725920635246098,-6.8491595307885,5.88194049412036,24.1432436317404,-1.296162557161529,-0.04864440101812736,-14.96224560965362,0.478700322823495,-1.091232069297356,0.123974779126882,-0.6439439037500084,-6.247834970494577,4.417810643375833,5.440755601708917,-0.2340342034613131,-0.03960179628148051,-1.675052573513713,0.03539625219881617,-0.01951429938963704,-0.002914085665065407,-0.5020671298666727,-3.152900287333658,2.875591642448119,-0.02534045561543922,0.01455989494121055,0.01712121255203309,0.0006249467355900694,-0.06238179829743803,0.05821539657382217,0.005137233134650138,0.0374709321867385,-0.07969413765393824,-0.2937436801141853,0.06978886406061049,0.01367066748985461,0.01606209824928972,-0.0006086892019978346,-0.01399020808456201,0.01408626324574684,0.002671963312105274,0.004257344905401243,-0.005340143460163175,-0.0007312072245237275,-0.0001687433924927976,0.006456287162506276,0.007570092053714329,0.001050935266379243,0.00295500019294429,0.01460836282140495,-0.01683984250804536,-0.000409003326564604,0.0620152126786478,0.05939751945257545,-0.005322753153880553,-0.0371362020760273,-0.08097783813705492,0.06959539442653273,-0.2930822934784301,0.01393834170540003,-0.01599370768824834,-0.0003682338862969275,0.01388330493568373,0.01442657199555634,-0.00274292816504451,-0.004197519394084437,-0.005432999023952822,-0.0001719424933351283,-0.0006901693997900645,0.006440314308633613,-0.007433331101904016,-0.0003313586660085944,-0.003052900656184943;

    // [NEW] H2Hinf Trajectory 2 (reduced domain of attraction): Gain Matrix 8 [TRY THIS ONE]
    K << -0.9132946313073804, 5.608219057174488, 6.049704650196739, -23.20025951654861, -1.630546515546394,
        0.02148077682426153, 14.65912470456652, 0.6728633659104601, -0.01235464436009421, -1.182733819870061,
        -0.6795341654247624, 5.631597220118333, 4.260767271616122, -5.301088138961158, -0.3011658470382209,
        0.03028996800792656, 1.651747291855211, 0.05700756111732627, -0.008342173470425538, -0.02199791243939212,
        -0.474869541799516, 2.398147698508092, 3.206342458002378, 0.01756267237423986, -0.8371352936136646,
        -6.451175152682915, 5.714997803891847, 23.74476540619154, -1.359244288115006, -0.03501065071649617,
        -14.7614012535182, 0.5296927819666141, -1.177068417141205, 0.06488221914310917, -0.5996191351738775,
        -6.052186540020592, 4.333474628422141, 5.368238675233806, -0.252722863927784, -0.03743399824551547,
        -1.660067835952305, 0.0424408621650129, -0.02188313316014417, -0.00462821048595196, -0.4158963883285703,
        -2.944596222015817, 2.795327009132437, -0.01736331816698299, 0.01331388589603127, 0.01654085920647495,
        0.0003927350302298688, -0.0617037094224527, 0.05486112406384938, 0.004539640638941521, 0.03704954900985658,
        -0.0780765301973939, -0.2945449582188707, 0.06945469059894138, 0.01269067517417017, 0.01581301280421729,
        -0.0005887749746805169, -0.01384427260989705, 0.01345076981568556, 0.002619426073617202, 0.004222211097536802,
        -0.005196568005687351, -0.0007507059886165572, -0.0001756837151079768, 0.005919234919065153,
        0.007306907668689294, 0.0007442649416933643, 0.002440815396601709, 0.01314508293317239, -0.01624201547570362,
        -0.0004436165517214821, 0.06118101463472548, 0.05573754272493357, -0.004697199104652598, -0.03668599270697293,
        -0.07932540983009606, 0.06946780394207275, -0.2940573375792874, 0.01276919356825688, -0.0156726380548064,
        -0.0003891507859917382, 0.01371836392024517, 0.01374154472879415, -0.002671458920751988, -0.004166211578938072,
        -0.005285545502828642, -0.0001738078621249789, -0.0007143633361166265, 0.005788438251821402,
        -0.007158529385822105, -0.0003383310614920475, -0.002509037396835588;

    // [NEW] H2Hinf Trajectory 2 (reduced domain of attraction): Gain Matrix 9
    // K <<
    // -0.7604973113530539,5.033861340561719,6.106959667908205,-20.47814892182359,-0.9187483378499388,0.01707253588946513,13.47555571435273,0.3039615340059609,0.09660736594784301,-0.4902438855377548,-0.5205533381565228,4.888501504469406,4.292286978317037,-4.815493131603923,-0.1653564597919631,0.01091129074531005,1.551053796335206,0.01886111559398523,-0.001794593116946282,-0.007392784410718717,-0.4044521571629681,2.255858355849606,3.252673521771921,0.01647257056076734,-0.6875908399127524,-5.978362820160391,5.772187588937429,21.1873040372578,-0.7558044670584178,-0.01444113624536811,-13.63223110564365,0.2556479539991252,-0.497698208346612,0.09435266031743657,-0.4581279828705764,-5.370174142753162,4.3792747822111,4.902236374564965,-0.1461938141555669,-0.01400181886332244,-1.564118552702567,0.01283262595808514,-0.007428824442969328,-0.0008950114038150069,-0.3512049341224341,-2.851028352137182,2.828317877385852,-0.008760351719865769,0.05215749676826432,0.01355426795054869,0.001211644542124759,-0.0429222880369898,0.1945327914334896,0.01380690105522513,0.02642196009022858,-0.1537998528242752,-0.1685570521950983,0.06557408989271397,0.04849351850639506,0.01189728375926594,-0.001277084954200808,-0.009549300943955964,0.04432714228175044,0.007180093001268379,0.002953081690480119,-0.01404544241761983,0.001572611850567674,0.0001489462405799563,0.0241430201648667,0.006298969483409939,0.002086422139957753,0.00756541518282833,0.05050008232462123,-0.01352493507027024,0.0006392868530591934,0.04438473937501028,0.1922542241186693,-0.0144137318078911,-0.02705696964771588,-0.1534049910880334,0.06479470045012348,-0.1687355914768646,0.04755501807381753,-0.0124218938108711,-0.0009230041098574171,0.00994219867232387,0.04421089232934346,-0.007325231448825283,-0.002998865669719868,-0.01400316665179541,0.0001261945355539672,0.001589897379508571,0.02298170449087617,-0.006272239250377209,0.001196594842650153,-0.007823720153207392;

    // [NEW] H2Hinf Trajectory 2 (reduced domain of attraction): Gain Matrix 10
    // K <<
    // -0.6999081992287934,4.977829107771666,6.118846642395373,-20.15490891333257,-0.6484915106482018,0.01996358112070491,13.32205635012347,0.1611615713603977,0.1528979770426976,-0.3304127588310459,-0.4571396904129896,4.813305296169513,4.297284001309388,-4.752859676857947,-0.1088934274117203,0.008367664689769115,1.537994124959343,0.004112735887706567,0.001359974546714849,-0.0049896294598471,-0.3790982829235489,2.233383227958569,3.26319143387716,0.01758020109698871,-0.625128405807678,-5.913051172749369,5.784373270007086,20.81561885173971,-0.4993535444966218,-0.01748529839301083,-13.45936155101559,0.1243818859247189,-0.3435222171892381,0.1491640355581193,-0.3958039400711056,-5.28307597850702,4.374476027013768,4.83078393918234,-0.09271878514039754,-0.01115471405382689,-1.549260250461695,-0.001330692333432507,-0.004997697734374151,0.002189961819353507,-0.3279936012544961,-2.826209948356162,2.84117879684929,-0.009679791989353606,0.07322495015111403,0.01222932168074949,0.001643012062459026,-0.03551009597750271,0.2706149869265611,0.01784045204284729,0.02130118128838535,-0.1938359872574396,-0.1022571814907893,0.07331451824542647,0.06758553862166505,0.01044639676084966,-0.001041375252542299,-0.00769476932671249,0.06085177888671425,0.008604835009350583,0.002294390909496004,-0.0187518179935696,0.002225045510286722,0.0005503363094071356,0.03379056985502203,0.005745769404600603,0.002871101728476874,0.009679179838265583,0.07137322025865449,-0.01237558938132471,0.001337575576897882,0.03760875009270626,0.2674728644526145,-0.01855789212989184,-0.02212602909639714,-0.1928724266730818,0.07198142376653832,-0.1023842619281037,0.06647360553159966,-0.01124527477752556,-0.0006993306973842984,0.008188099487770805,0.0605808995143846,-0.00882888736676371,-0.002331766318690027,-0.0186565245612758,0.00050515610355849,0.002249377091890955,0.03245781133323852,-0.005728504677171601,0.002187008788586626,-0.01005292777678852;

    // [NEW] H2Hinf Trajectory 2 (reduced domain of attraction): Gain Matrix 11
    // K <<
    // -0.7044095509057801,5.156943379506992,6.13446060874248,-20.98799817494461,-0.6877306543738536,0.02890032212183476,13.69988478263932,0.1753441768930928,0.2616596121554304,-0.4883418899063706,-0.4668938662669325,5.044388397017558,4.310634680243761,-4.900043955186884,-0.1156314944898267,0.0147924200737909,1.569175221799128,0.005392316584619191,0.001743511048287996,-0.006166965789131305,-0.3774126873366968,2.277488933875767,3.268196017524757,0.02232250719658695,-0.6289325369832793,-6.062303479120118,5.79813202665058,21.60969779358999,-0.5185445648299346,-0.02160260138436423,-13.82750781649277,0.1218870400779919,-0.4971080075235876,0.257079660286979,-0.4010992535073354,-5.495850479890411,4.382764481519708,4.974572963676615,-0.09305357760338001,-0.01766598704691031,-1.58007884220669,-0.001475205907892568,-0.006038392035999753,0.00266014529823395,-0.3236362378571443,-2.855181391307623,2.852546420975565,-0.009357872048010245,0.0623903818756826,0.01217892414641164,0.001463116678841815,-0.03497559195656233,0.2388788417570752,0.01681979970596853,0.02052431120572943,-0.1774926160429725,-0.09398391818741191,0.0645350613697339,0.0581965028731419,0.01056680639190566,-0.0007035734805978103,-0.00748226026273319,0.05484752143762402,0.00830328045172467,0.002180503589649252,-0.01765775025457912,0.002117871788585878,0.000515203439378656,0.02847518633114661,0.005623573693895415,0.002400632349583652,0.009026364366914201,0.06067436484824962,-0.01211226929684149,0.001378565316764451,0.03611697164659639,0.2356207419595631,-0.01743818213987033,-0.02087821682780136,-0.1764787452083036,0.06314379568875489,-0.0941008500340766,0.05715463742889217,-0.01105027263453733,-0.0003488684182774979,0.007763036115807287,0.05459142797530653,-0.008508937611319942,-0.002182138419957905,-0.01756135605701641,0.0004694125157902191,0.002142329011619505,0.02719737895079824,-0.005507012586067129,0.001910382274069298,-0.009351752695790447;

    // LKF Adjust Parameters

    // LKF_X0 << 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23; // x hat inicial (DEBUG)
    // LKF_X0 << 0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; // x hat inicial
    LKF_X0 << 0, 0, 1, equil_phi, equil_theta, equil_psii, equil_g1, equil_g2, equil_aR, equil_aL, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0;  // x hat inicial
    // LKF_P0 << 1.0E-02*Eigen::MatrixXd::Identity(23,23);

    // LKF_P0 << 4.0E-02*Eigen::MatrixXd::Identity(23,23); // New adjust for 30 deg initial conditions

    LKF_P0 << Eigen::MatrixXd::Zero(23, 23);  // ZSE adjust for 30 deg initial conditions
    LKF_P0(0, 0) = pow(0.5 / 3.0, 2.0);
    LKF_P0(1, 1) = pow(0.5 / 3.0, 2.0);
    LKF_P0(2, 2) = pow(0.5 / 3.0, 2.0);
    LKF_P0(3, 3) = pow((PI / 4.0) / 3.0, 2.0);
    LKF_P0(4, 4) = pow((PI / 4.0) / 3.0, 2.0);
    LKF_P0(5, 5) = pow((PI / 4.0) / 3.0, 2.0);
    LKF_P0(6, 6) = pow((PI / 4.0) / 3.0, 2.0);
    LKF_P0(7, 7) = pow((PI / 4.0) / 3.0, 2.0);
    LKF_P0(8, 8) = pow((PI / 4.0) / 3.0, 2.0);
    LKF_P0(9, 9) = pow((PI / 4.0) / 3.0, 2.0);
    LKF_P0(10, 10) = pow(1.0 / 3.0, 2.0);
    LKF_P0(11, 11) = pow(1.0 / 3.0, 2.0);
    LKF_P0(12, 12) = pow(1.0 / 3.0, 2.0);
    LKF_P0(13, 13) = pow(1.0 / 3.0, 2.0);
    LKF_P0(14, 14) = pow(1.0 / 3.0, 2.0);
    LKF_P0(15, 15) = pow(1.0 / 3.0, 2.0);
    LKF_P0(16, 16) = pow(1.0 / 3.0, 2.0);
    LKF_P0(17, 17) = pow(1.0 / 3.0, 2.0);
    LKF_P0(18, 18) = pow(1.0 / 3.0, 2.0);
    LKF_P0(19, 19) = pow(1.0 / 3.0, 2.0);
    LKF_P0(20, 20) = pow(1.0 / 3.0, 2.0);
    LKF_P0(21, 21) = pow(1.0 / 3.0, 2.0);
    LKF_P0(22, 22) = pow(1.0 / 3.0, 2.0);

    // LKF_Q << 1.0E-05*Eigen::MatrixXd::Identity(23,23); // OLD adjust

    LKF_Q << Eigen::MatrixXd::Zero(23, 23);  // ZSE adjust
    LKF_Q(0, 0) = pow(1.0E-04 / 3.0, 2.0);
    LKF_Q(1, 1) = pow(1.0E-04 / 3.0, 2.0);
    LKF_Q(2, 2) = pow(1.0E-04 / 3.0, 2.0);
    LKF_Q(3, 3) = pow(1.0E-04 / 3.0, 2.0);
    LKF_Q(4, 4) = pow(1.0E-04 / 3.0, 2.0);
    LKF_Q(5, 5) = pow(1.0E-04 / 3.0, 2.0);
    LKF_Q(6, 6) = pow(1.0E-04 / 3.0, 2.0);
    LKF_Q(7, 7) = pow(1.0E-04 / 3.0, 2.0);
    // ZSE_WG(8,8) = 1.0E-04;
    // ZSE_WG(9,9) = 1.0E-04;
    LKF_Q(8, 8) = pow(1.5E-04 / 3.0, 2.0);
    LKF_Q(9, 9) = pow(1.5E-04 / 3.0, 2.0);
    LKF_Q(10, 10) = pow(1.0E-04 / 3.0, 2.0);
    LKF_Q(11, 11) = pow(1.0E-04 / 3.0, 2.0);
    LKF_Q(12, 12) = pow(1.0E-04 / 3.0, 2.0);
    LKF_Q(13, 13) = pow(0.01 / 3.0, 2.0);
    LKF_Q(14, 14) = pow(0.01 / 3.0, 2.0);
    LKF_Q(15, 15) = pow(0.01 / 3.0, 2.0);
    LKF_Q(16, 16) = pow(0.05 / 3.0, 2.0);
    LKF_Q(17, 17) = pow(0.05 / 3.0, 2.0);
    LKF_Q(18, 18) = pow(1.0E-04 / 3.0, 2.0);
    LKF_Q(19, 19) = pow(1.0E-04 / 3.0, 2.0);
    LKF_Q(20, 20) = pow(0.01 / 3.0, 2.0);
    LKF_Q(21, 21) = pow(0.01 / 3.0, 2.0);
    LKF_Q(22, 22) = pow(0.01 / 3.0, 2.0);

    // LKF_Q << 1.0E-03*Eigen::MatrixXd::Identity(23,23); // NEW adjust
    //		LKF_Q << Eigen::MatrixXd::Zero(23,23); // Precise adjust
    //		LKF_Q(0,0) = 1.0E-03;
    //		LKF_Q(1,1) = 1.0E-03;
    //		LKF_Q(2,2) = 1.0E-03;
    //                LKF_Q(3,3) = 1.0E-03;
    //                LKF_Q(4,4) = 1.0E-03;
    //                LKF_Q(5,5) = 1.0E-05;
    //                LKF_Q(6,6) = 1.0E-03;
    //                LKF_Q(7,7) = 1.0E-03;
    //                LKF_Q(8,8) = 1.0E-05;
    //                LKF_Q(9,9) = 1.0E-05;
    //                LKF_Q(10,10) = 1.0E-03;
    //                LKF_Q(11,11) = 1.0E-03;
    //                LKF_Q(12,12) = 1.0E-03;
    //                LKF_Q(13,13) = 1.0E-03;
    //                LKF_Q(14,14) = 1.0E-03;
    //                LKF_Q(15,15) = 1.0E-05;
    //                LKF_Q(16,16) = 1.0E-03;
    //                LKF_Q(17,17) = 1.0E-03;
    //                LKF_Q(18,18) = 1.0E-05;
    //                LKF_Q(19,19) = 1.0E-05;
    //                LKF_Q(20,20) = 1.0E-03;
    //                LKF_Q(21,21) = 1.0E-03;
    //                LKF_Q(22,22) = 1.0E-03;
    LKF_R << Eigen::MatrixXd::Zero(16, 16);
    LKF_R(0, 0) = pow(0.06, 2.0);
    LKF_R(1, 1) = pow(0.06, 2.0);
    LKF_R(2, 2) = pow(0.204, 2.0);
    LKF_R(3, 3) = pow(1.0472E-03, 2.0);
    LKF_R(4, 4) = pow(1.0472E-03, 2.0);
    LKF_R(5, 5) = pow(0.01, 2.0);
    LKF_R(6, 6) = pow(6.624E-03, 2.0);
    LKF_R(7, 7) = pow(6.624E-03, 2.0);
    LKF_R(8, 8) = pow(0.08, 2.0);
    LKF_R(9, 9) = pow(0.002, 2.0);
    LKF_R(10, 10) = pow(0.002, 2.0);
    LKF_R(11, 11) = pow(0.02, 2.0);
    LKF_R(12, 12) = pow(2.2689E-03, 2.0);
    LKF_R(13, 13) = pow(2.2689E-03, 2.0);
    LKF_R(14, 14) = pow(0.2031, 2.0);
    LKF_R(15, 15) = pow(0.2031, 2.0);
  }

public:
  std::vector<double> execute(simulator_msgs::SensorArray arraymsg)
  {
    // Instant time k counter
    static double count = 0;

    // Integrator variables
    static double xint, x_ant = 0;
    static double yint, y_ant = 0;
    static double zint, z_ant = 0;
    static double yawint, yaw_ant = 0;

    // Equilibrium values
    //		double equil_phi     = 0;
    //		double equil_theta   = 0;
    //		double equil_psii    = 0;
    //		double equil_g1      = 1.316967145565129e-04;
    //		double equil_g2      = 0.013960153151247;
    //		double equil_aR      = 0.014005280124626;
    //		double equil_aL      = 0.013809089793911;
    //		double equil_fR      = 11.732256727680697;
    //		double equil_fL      = 11.767602459917352;
    //		double equil_tauaR   = 4.138868162580376e-07;
    //		double equil_tauaL   = 1.012099978192413e-05;

    // Equilibrium states and inputs (for state estimation)
    Eigen::MatrixXd Xeq(23, 1);
    Eigen::MatrixXd Ueq(4, 1);
    Xeq << 0, 0, 0, equil_phi, equil_theta, equil_psii, equil_g1, equil_g2, equil_aR, equil_aL, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0;
    Ueq << equil_fR, equil_fL, equil_tauaR, equil_tauaL;

    // LKF variables
    static Eigen::MatrixXd LKF_xhat(23, 1);
    static Eigen::MatrixXd LKF_xhatprev(23, 1);
    static Eigen::MatrixXd LKF_Pxx(23, 23);
    static Eigen::MatrixXd LKF_Pxxprev(23, 23);

    static Eigen::MatrixXd Inputprev(4, 1);

    // Initialization of the LKF variables
    if (count == 0)
    {
      LKF_xhatprev << LKF_X0;
      LKF_Pxxprev << LKF_P0;
      Inputprev << Ueq;  // u anterior
    }

    // Getting sensor data
    // int i = 0;
    simulator_msgs::Sensor msgstates;
    simulator_msgs::Sensor mainbody_sensordata;
    simulator_msgs::Sensor rightpropeller_sensordata;
    simulator_msgs::Sensor leftpropeller_sensordata;
    simulator_msgs::Sensor load_sensordata;
    simulator_msgs::Sensor rightservo_sensordata;
    simulator_msgs::Sensor leftservo_sensordata;
    simulator_msgs::Sensor rodx_sensordata;
    simulator_msgs::Sensor rody_sensordata;

    msgstates = arraymsg.values.at(0);
    mainbody_sensordata = arraymsg.values.at(1);
    rightpropeller_sensordata = arraymsg.values.at(2);
    leftpropeller_sensordata = arraymsg.values.at(3);
    load_sensordata = arraymsg.values.at(4);
    rightservo_sensordata = arraymsg.values.at(5);
    leftservo_sensordata = arraymsg.values.at(6);
    rodx_sensordata = arraymsg.values.at(7);
    rody_sensordata = arraymsg.values.at(8);

    // Reference

    // Generate trajectory
    Eigen::MatrixXd csiref(3, 1);
    Eigen::MatrixXd csirefdot(3, 1);
    Eigen::MatrixXd csirefddot(3, 1);
    // int which_trajectory = 0; // Hovering
    // int which_trajectory = 1; // Trajetoria artigo SBAI (mais rapida)
    int which_trajectory = 2;  // Second trajectory from Rego's Master thesis
    routines::generate_Trajectory(count, T, which_trajectory, csiref, csirefdot, csirefddot);

    Xref << csiref, equil_phi, equil_theta, equil_psii, equil_g1, equil_g2, equil_aR, equil_aL, csirefdot, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0;

    // Disturbance forces
    Eigen::MatrixXd dtrb(3, 1);
    static Eigen::MatrixXd dtrb_prev(3, 1);
    int which_disturbance = 0;  // No disturbance forces
    // int which_disturbance = 1; // Disturbance forces from Rego's Master thesis, second trajectory
    dtrb = routines::generate_Disturbances(count, T, which_disturbance);

    // Wind disturbances
    Eigen::MatrixXd wind(3, 1);
    static Eigen::MatrixXd wind_prev(3, 1);
    // int which_wind = 0; // No wind disturbances
    int which_wind = 1;  // Wind disturbances based on Rego's Master thesis, second trajectory
    wind = routines::generate_Wind(count, T, which_wind);

    // Disturbance forces filtering
    if (count == 0)
    {
      dtrb_prev << 0, 0, 0;
    }
    dtrb(0, 0) = routines::first_order_filter(dtrb_prev(0, 0), dtrb(0, 0));
    dtrb(1, 0) = routines::first_order_filter(dtrb_prev(1, 0), dtrb(1, 0));
    dtrb(2, 0) = routines::first_order_filter(dtrb_prev(2, 0), dtrb(2, 0));
    dtrb_prev << dtrb;

    // Wind filtering
    if (count == 0)
    {
      wind_prev << 0, 0, 0;
    }
    wind(0, 0) = routines::first_order_filter(wind_prev(0, 0), wind(0, 0));
    wind(1, 0) = routines::first_order_filter(wind_prev(1, 0), wind(1, 0));
    wind(2, 0) = routines::first_order_filter(wind_prev(2, 0), wind(2, 0));
    wind_prev << wind;

    // Aerodynamic disturbances
    Eigen::MatrixXd aerodtrb(3, 1);
    aerodtrb = routines::generate_AerodynDisturbances(
        msgstates.values.at(10), msgstates.values.at(11), msgstates.values.at(12),  // xdot, ydot, zdot
        msgstates.values.at(3), msgstates.values.at(4), msgstates.values.at(5),     // phi, theta, psi
        wind);                                                                      // Wind disturbances

    // MATLAB code
    //              disturb(:,i) = generator_Disturbances(tilttime(i),finaltime,scenario.disturbances);
    //              if(i==1)
    //                  disturb(1,i) = first_order_filter(0,disturb(1,i));
    //                  disturb(2,i) = first_order_filter(0,disturb(2,i));
    //                  disturb(3,i) = first_order_filter(0,disturb(3,i));
    //              else
    //                  disturb(1,i) = first_order_filter(disturb(1,i-1),disturb(1,i));
    //                  disturb(2,i) = first_order_filter(disturb(2,i-1),disturb(2,i));
    //                  disturb(3,i) = first_order_filter(disturb(3,i-1),disturb(3,i));
    //              end

    // Generate current measurement
    std::vector<double> y;
    std::vector<int> I;
    routines::generate_Measurement_truncated(count, T, mainbody_sensordata, rightpropeller_sensordata,
                                             leftpropeller_sensordata, load_sensordata, rightservo_sensordata,
                                             leftservo_sensordata, rodx_sensordata, rody_sensordata, y, I);
    //		routines::generate_Measurement(count, T,
    //		  		               mainbody_sensordata,
    //		                               rightpropeller_sensordata,
    //		                               leftpropeller_sensordata,
    //		                               load_sensordata,
    //		                               rightservo_sensordata,
    //		                               leftservo_sensordata,
    //		                               rodx_sensordata,
    //		                               rody_sensordata,
    //		                               y, I);
    //		routines::generate_Measurement_clean(count, T,
    //		  		                     mainbody_sensordata,
    //                                                     rightpropeller_sensordata,
    //		                                     leftpropeller_sensordata,
    //		                                     load_sensordata,
    //		                                     rightservo_sensordata,
    //		                                     leftservo_sensordata,
    //		                                     rodx_sensordata,
    //		                                     rody_sensordata,
    //		                                     y, I);

    // Linear Kalman Filter estimation
    linear_kalman_filter::execute(LKF_xhatprev - Xeq, Inputprev - Ueq, y, I, LKF_Pxxprev, LKF_Q, LKF_R, LKF_xhat,
                                  LKF_Pxx);
    LKF_xhat = LKF_xhat + Xeq;
    // LKF_xhat = LKF_xhatprev; //(DISABLE ESTIMATION)

    // Linear Kalman Filter confidence limits
    Eigen::MatrixXd LKF_conflimits(46, 1);
    LKF_conflimits = routines::get_LKFconfidencelimits(LKF_Pxx);

    // Convertendo velocidade angular
    std::vector<double> etadot = routines::wIIB2EtaDot(msgstates.values.at(13),  // wIIL_x
                                                       msgstates.values.at(14),  // wIIL_y
                                                       msgstates.values.at(15),  // wIIL_z
                                                       msgstates.values.at(3),   // phi
                                                       msgstates.values.at(4),   // theta
                                                       msgstates.values.at(5));  // psii

    // Integrador Trapezoidal (realimentacao estados reais)
    //		double x_atual = msgstates.values.at(0) - Xref(0);
    //		xint = xint + (T/2)*(x_atual + x_ant);
    //		x_ant = x_atual;
    //		double y_atual = msgstates.values.at(1) - Xref(1);
    //		yint = yint + (T/2)*(y_atual + y_ant);
    //		y_ant = y_atual;
    //		double z_atual = msgstates.values.at(2) - Xref(2);
    //		zint = zint + (T/2)*(z_atual + z_ant);
    //		z_ant = z_atual;
    //		double yaw_atual = msgstates.values.at(5) - Xref(5);
    //		yawint = yawint + (T/2)*(yaw_atual + yaw_ant);
    //		yaw_ant = yaw_atual;

    // Integrador Trapezoidal (usando estados estimados pelo LKF)
    double x_atual = LKF_xhat(0) - Xref(0);
    xint = xint + (T / 2) * (x_atual + x_ant);
    x_ant = x_atual;
    double y_atual = LKF_xhat(1) - Xref(1);
    yint = yint + (T / 2) * (y_atual + y_ant);
    y_ant = y_atual;
    double z_atual = LKF_xhat(2) - Xref(2);
    zint = zint + (T / 2) * (z_atual + z_ant);
    z_ant = z_atual;
    double yaw_atual = LKF_xhat(5) - Xref(5);
    yawint = yawint + (T / 2) * (yaw_atual + yaw_ant);
    yaw_ant = yaw_atual;

    // State vector (augmented)
    Xstates << msgstates.values.at(0),  // x
        msgstates.values.at(1),         // y
        msgstates.values.at(2),         // z
        msgstates.values.at(3),         // roll
        msgstates.values.at(4),         // pitch
        msgstates.values.at(5),         // yaw
        msgstates.values.at(8),         // g1 x
        msgstates.values.at(9),         // g2 y
        msgstates.values.at(6),         // aR
        msgstates.values.at(7),         // aL
        msgstates.values.at(10),        // vx
        msgstates.values.at(11),        // vy
        msgstates.values.at(12),        // vz
        etadot.at(0),                   // droll
        etadot.at(1),                   // pitch
        etadot.at(2),                   // yaw
        msgstates.values.at(18),        // g1dot
        msgstates.values.at(19),        // g2dot
        msgstates.values.at(16),        // aRdot
        msgstates.values.at(17),        // aLdot
        xint, yint, zint, yawint;

    // State vector LKF (augmented)
    Eigen::MatrixXd Xstates_LKF(24, 1);
    Xstates_LKF << LKF_xhat.block(0, 0, 20, 1),  // xhat
        xint, yint, zint, yawint;

    // Tracking error
    Erro = Xstates - Xref;

    // Tracking error (using estimation from LKF)
    Eigen::MatrixXd Erro_LKF(24, 1);
    Erro_LKF = Xstates_LKF - Xref;

    // Null inputs (lack of gravity/free fall tests)
    // Input << 0, 0, 0, 0, 0, 0, 0;

    // Disturbances testing (lack of gravity)
    // Input << 0, 0, 0, 0, 0.1, 0, 0;
    // Input << 0, 0, 0, 0, 0, 0.1, 0;
    // Input << 0, 0, 0, 0, 0, 0, 0.5;

    // Equilibrium input
    // Eigen::MatrixXd ueq(4,1);
    // ueq << equil_fR, equil_fL, equil_tauaR, equil_tauaL;
    // Input << ueq, 0, 0, 0;

    // Control law (using real states)
    //		Input << -K*Erro, 0, 0, 0;
    //              Input << -K*Erro, dtrb;

    // Control law (using estimated states from LKF)
    //		Input << -K*Erro_LKF, 0, 0, 0;
    // Input << -K*Erro_LKF, dtrb;

    // Control law (using estimated states from LKF)
    //		Input << -K*Erro_LKF, 0, 0, 0;
    Input << -K * Erro_LKF, dtrb + aerodtrb;

    // Equilibrium feedforward
    //		Eigen::MatrixXd ueq(7,1);
    //		ueq << equil_fR, equil_fL, equil_tauaR, equil_tauaL, 0, 0, 0;
    //		Input = Input + ueq;

    // Reference feedfoward
    Eigen::MatrixXd qref(10, 1);
    qref << csiref, equil_phi, equil_theta, equil_psii, equil_g1, equil_g2, equil_aR, equil_aL;
    Eigen::MatrixXd qrefdot(10, 1);
    qrefdot << csirefdot, 0, 0, 0, 0, 0, 0, 0;
    Eigen::MatrixXd qrefddot(10, 1);
    qrefddot << csirefddot, 0, 0, 0, 0, 0, 0, 0;
    Eigen::MatrixXd uref(7, 1);
    uref << feedforward::compute(qref, qrefdot, qrefddot), 0, 0, 0;
    Input = Input + uref;

    // Feedforward
    // Input(0) = Input(0) + 12.6005;
    // Input(1) = Input(1) + 12.609;
    // Input(0) = Input(0) + equil_fR;
    // Input(1) = Input(1) + equil_fL;
    // Input(2) = Input(2) + equil_tauaR;
    // Input(3) = Input(3) + equil_tauaL;
    // Input(0) = Input(0) + varfeedforward(0,0);
    // Input(1) = Input(1) + varfeedforward(1,0);
    // Input(2) = Input(2) + varfeedforward(2,0);
    // Input(3) = Input(3) + varfeedforward(3,0);
    count++;

    // Storing values for the next iteration
    LKF_xhatprev << LKF_xhat;
    LKF_Pxxprev << LKF_Pxx;
    Inputprev << Input.block(0, 0, 4, 1);

    // Managing printed output data

    // States
    // X << Xstates;

    // States, LKF data and size of measured vector
    // X << Xstates, LKF_xhat, LKF_conflimits, y.size(), I.size();

    // States, LKF data, size of measured vector and disturbances
    X << Xstates, LKF_xhat, LKF_conflimits, y.size(), I.size(), dtrb, aerodtrb;

    // Stop criterion
    if (count >= 5001)
    {
      X << 1;  // Force error in Eigen, kills the controller process
    }

    std::vector<double> out(Input.data(), Input.data() + Input.rows() * Input.cols());
    return out;
  }

public:
  std::vector<double> Reference()
  {
    std::vector<double> out(Xref.data(), Xref.data() + Xref.rows() * Xref.cols());
    return out;
  }

public:
  std::vector<double> Error()
  {
    std::vector<double> out(Erro.data(), Erro.data() + Erro.rows() * Erro.cols());
    return out;
  }

public:
  std::vector<double> State()
  {
    std::vector<double> out(X.data(), X.data() + X.rows() * X.cols());
    return out;
  }
};

extern "C" {
Icontroller* create(void)
{
  return new vant2load_Franklin_LKF;
}
void destroy(Icontroller* p)
{
  delete p;
}
}
